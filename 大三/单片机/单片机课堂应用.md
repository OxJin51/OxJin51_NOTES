### ä»£ç  1ï¼š`09_19_01.c` (åº“å‡½æ•°æµæ°´ç¯)

#### 1. ä»£ç å®ç°æ•ˆæœ (What it does)

ä¸»ç¨‹åºï¼šP2 å£è¿æ¥çš„ 8 ä¸ª LED ç¯ï¼Œä»é«˜ä½ï¼ˆD7ï¼‰å‘ä½ä½ï¼ˆD0ï¼‰ä¾æ¬¡ç‚¹äº®ï¼Œå¹¶å¾ªç¯æ»šåŠ¨ï¼ˆè·‘é©¬ç¯æ•ˆæœï¼‰ã€‚

#### 2. å®ç°æ€è·¯ (How it works)

- **åº“å‡½æ•°ç§»ä½ï¼š** ä½¿ç”¨ `<intrins.h>` åº“ä¸­çš„ `_cror_(a, 1)` å‡½æ•°å®ç°å¾ªç¯å³ç§»ã€‚
- **å¾ªç¯ç‰¹æ€§ï¼š** ä¸æ™®é€š `>>` ç§»ä½ä¸åŒï¼Œ`_cror_` ä¼šå°†ç§»å‡ºçš„æœ€ä½ä½è¡¥å›åˆ°æœ€é«˜ä½ï¼Œä¿è¯æ•°æ®ä¸ä¼šä¸¢å¤±ï¼Œå®ç°çœŸæ­£çš„â€œå¾ªç¯â€ã€‚
- **å»¶æ—¶æ§åˆ¶ï¼š** ä½¿ç”¨ `delay` å‡½æ•°æ§åˆ¶æµæ°´ç¯æµåŠ¨çš„é€Ÿåº¦ã€‚

#### 3. ç¡¬ä»¶è¿æ¥ (Hardware Wiring)

- **P2å£æ¥å‘å…‰äºŒæç®¡**
- **è¿æ¥æ–¹å¼ï¼š** æ ¹æ®ä»£ç  `a=0x80` (1000 0000) ä¸” `P2=a`ï¼Œé«˜ç”µå¹³ç‚¹äº®
  - *æ³¨ï¼šæ ‡å‡† 51 å®éªŒæ¿é€šå¸¸ä¸ºä½ç”µå¹³ç‚¹äº®ï¼Œä½†æ­¤ä»£ç é€»è¾‘å€¾å‘äºé«˜ç”µå¹³é€»è¾‘ï¼Œæˆ–æ„åœ¨æ§åˆ¶â€œäº®ç‚¹â€æµåŠ¨ã€‚*

#### 4. ä»£ç æ³¨é‡Šè¡¥å…… (Comment Enhancement)

```c
// ======= å«æ³¨é‡Šç‰ˆæœ¬ =======
#include<reg52.h>
#include<intrins.h> // åŒ…å«å¾ªç¯ç§»ä½å‡½æ•° _cror_ çš„å¤´æ–‡ä»¶

unsigned int a;

// å»¶æ—¶å‡½æ•°
void delay(unsigned int z,unsigned int w)
{
    unsigned int x,y;
    for(x=0;x<z;x++)
        for(y=0;y<w;y++);
}

void main()
{
    a = 0x80; // åˆå§‹åŒ–ï¼š1000 0000ï¼Œæœ€é«˜ä½ç‚¹äº®
    while(1)
    {
        P2 = a;             // å°†æ•°æ®è¾“å‡ºåˆ° P2 å£é©±åŠ¨ LED
        delay(1000, 40/4);  // å»¶æ—¶çº¦ 0.5/4 = 0.125ç§’ (åŸºäºè¯´æ˜æ–‡æ¡£)
        a = _cror_(a, 1);   // å¾ªç¯å³ç§» 1 ä½ (10000000 -> 01000000)
    }
}
```

#### 5. æ’ç‰ˆä¼˜åŒ–åçš„æœ€ç»ˆä»£ç  (Formatted Code)

```c
#include <reg52.h>
#include <intrins.h>

unsigned int a;

void delay(unsigned int z, unsigned int w)
{
    unsigned int x, y;
    for (x = 0; x < z; x++)
        for (y = 0; y < w; y++);
}

void main()
{
    a = 0x80;
    while (1)
    {
        P2 = a;
        delay(1000, 40 / 4);
        a = _cror_(a, 1);
    }
}
```

------

### ä»£ç  2ï¼š`09_19_02.c` (æ™®é€šç§»ä½æµæ°´ç¯)

#### 1. ä»£ç å®ç°æ•ˆæœ (What it does)

ä¸»ç¨‹åºï¼šLED ç¯ä»å·¦å‘å³ï¼ˆD7 åˆ° D0ï¼‰ä¾æ¬¡ç‚¹äº®ã€‚

å½“ç§»åŠ¨åˆ°æœ€åä¸€ä½ï¼ˆD0ï¼‰åï¼Œç«‹åˆ»å¤ä½å›åˆ° D7 é‡æ–°å¼€å§‹ï¼ˆéå¾ªç¯è¡”æ¥ï¼Œæ˜¯å¤ä½è¡”æ¥ï¼‰ã€‚

#### 2. å®ç°æ€è·¯ (How it works)

- **ä½è¿ç®—ç§»ä½ï¼š** ä½¿ç”¨ C è¯­è¨€æ ‡å‡†å³ç§»è¿ç®—ç¬¦ `>>`ã€‚
- **For å¾ªç¯æ§åˆ¶ï¼š** ä¹Ÿå°±æ˜¯é€šå¸¸è¯´çš„â€œæ•°ç»„æ³•â€æˆ–â€œç§»ä½æ³•â€çš„åŸºç¡€ï¼Œé€šè¿‡ `i<8` é™åˆ¶ç§»åŠ¨æ¬¡æ•°ã€‚
- **æ•°æ®ä¸¢å¤±ç‰¹æ€§ï¼š** æ™®é€š `>>` ç§»ä½åï¼Œé«˜ä½è¡¥ 0ã€‚ç§»ä½ 8 æ¬¡å `a` å˜ä¸º 0ï¼Œæ‰€ä»¥å¿…é¡»åœ¨ `while(1)` å†…éƒ¨é‡æ–°èµ‹å€¼ `a=0x80`ã€‚

#### 3. ç¡¬ä»¶è¿æ¥ (Hardware Wiring)

- **P2å£æ¥å‘å…‰äºŒæç®¡**

#### 4. ä»£ç æ³¨é‡Šè¡¥å…… (Comment Enhancement)

```c
// ======= å«æ³¨é‡Šç‰ˆæœ¬ =======
#include<reg52.h>

unsigned int a, i;

void delay(unsigned int z, unsigned int w)
{
    unsigned int x, y;
    for(x=0; x<z; x++)
        for(y=0; y<w; y++);
}

void main()
{
    while(1)
    {
        a = 0x80; // æ¯æ¬¡å¾ªç¯å¼€å§‹é‡ç½®ä¸º 1000 0000
        for(i=0; i<8; i++) // å¾ªç¯ 8 æ¬¡ï¼Œå¯¹åº” 8 ä¸ª LED
        {
            P2 = a;             // è¾“å‡ºæ˜¾ç¤º
            delay(1000, 40/4);  // å»¶æ—¶
            a = a >> 1;         // å³ç§»ä¸€ä½ï¼Œé«˜ä½è¡¥0
        }
    }
}
```

#### 5. æ’ç‰ˆä¼˜åŒ–åçš„æœ€ç»ˆä»£ç  (Formatted Code)

```c
#include <reg52.h>

unsigned int a, i;

void delay(unsigned int z, unsigned int w)
{
    unsigned int x, y;
    for (x = 0; x < z; x++)
        for (y = 0; y < w; y++);
}

void main()
{
    while (1)
    {
        a = 0x80;
        for (i = 0; i < 8; i++)
        {
            P2 = a;
            delay(1000, 40 / 4);
            a = a >> 1;
        }
    }
}
```

------

### ä»£ç  3ï¼š`09_19_03.c` (æ•°ç»„æ³•èµ°é©¬ç¯)

#### 1. ä»£ç å®ç°æ•ˆæœ (What it does)

ä¸»ç¨‹åºï¼šP2 å£çš„ LED å®ç°å·¦ç§»æµæ°´ç¯æ•ˆæœï¼ˆç±»ä¼¼è¿›åº¦æ¡åŠ è½½ï¼‰ã€‚

$$
æ•ˆæœåºåˆ—ï¼šäº®1ä¸ª \rightarrow äº®2ä¸ª \rightarrow äº®3ä¸ª ... \rightarrow å…¨äº® \rightarrow å¾ªç¯ã€‚
$$

#### 2. å®ç°æ€è·¯ (How it works)

- **æŸ¥è¡¨æ³• (Look-up Table)ï¼š** ä½¿ç”¨ `code` å…³é”®å­—å®šä¹‰æ•°ç»„ `zyzmd[]`ï¼Œå°†é¢„è®¾å¥½çš„èŠ±æ ·æ•°æ®å­˜å‚¨åœ¨ ROM ä¸­ã€‚
- **äºŒè¿›åˆ¶è§„å¾‹ï¼š** æ•°ç»„å†…å®¹ `0x01` (00000001), `0x03` (00000011), `0x07` (00000111) ç­‰ï¼Œä½“ç°äº†é€ä¸ªå åŠ ç‚¹äº®çš„é€»è¾‘ã€‚

#### 3. ç¡¬ä»¶è¿æ¥ (Hardware Wiring)

- **P2å£æ¥å‘å…‰äºŒæç®¡**

#### 4. ä»£ç æ³¨é‡Šè¡¥å…… (Comment Enhancement)

```c
// ======= å«æ³¨é‡Šç‰ˆæœ¬ =======
#include<reg52.h>

unsigned int i;
// å®šä¹‰èµ°é©¬ç¯æ•°ç»„ï¼Œå­˜æ”¾åœ¨ code åŒºï¼ˆç¨‹åºå­˜å‚¨å™¨ï¼‰èŠ‚çœ RAM
// 0x01(0000 0001), 0x03(0000 0011)... 0xff(1111 1111)
unsigned int code zyzmd[] = {0x01, 0x03, 0x07, 0x0f, 0x1f, 0x3f, 0x7f, 0xff};

void delay(unsigned int z, unsigned int w)
{
    unsigned int x, y;
    for(x=0; x<z; x++)
        for(y=0; y<w; y++);
}

void main()
{
    while(1)
    {
        for(i=0; i<8; i++) // éå†æ•°ç»„ä¸­çš„ 8 ä¸ªçŠ¶æ€
        {
            P2 = zyzmd[i];      // å–å‡ºæ•°ç»„ç¬¬ i ä¸ªå…ƒç´ èµ‹ç»™ P2
            delay(1000, 40/4);  // å»¶æ—¶
        }
    }
}
```

#### 5. æ’ç‰ˆä¼˜åŒ–åçš„æœ€ç»ˆä»£ç  (Formatted Code)

```c
#include <reg52.h>

unsigned int i;
unsigned int code zyzmd[] = {0x01, 0x03, 0x07, 0x0f, 0x1f, 0x3f, 0x7f, 0xff};

void delay(unsigned int z, unsigned int w)
{
    unsigned int x, y;
    for (x = 0; x < z; x++)
        for (y = 0; y < w; y++);
}

void main()
{
    while (1)
    {
        for (i = 0; i < 8; i++)
        {
            P2 = zyzmd[i];
            delay(1000, 40 / 4);
        }
    }
}
```

------

### ä»£ç  4ï¼š`09_28_01.c` (æ•°ç ç®¡æ®µç æµ‹è¯•/åŒå‘æ˜¾ç¤º)

#### 1. ä»£ç å®ç°æ•ˆæœ (What it does)

ä¸»ç¨‹åºï¼šå°æ•°ç ç®¡æ˜¾ç¤º0~9ï¼Œå¤§æ•°ç ç®¡æ˜¾ç¤ºå¯¹åº”å°æ•°ç ç®¡+1çš„æ•°å­—ã€‚

P1 å£ï¼ˆå°æ•°ç ç®¡ï¼‰ï¼šä¾æ¬¡æ˜¾ç¤ºæ•°ç ç®¡æ®µç  0 åˆ° 9ã€‚

P2 å£ï¼ˆå¤§æ•°ç ç®¡ï¼‰ï¼šæ˜¾ç¤ºå°æ•°ç ç®¡+1çš„æ•°å­—

#### 2. å®ç°æ€è·¯ (How it works)

- **å…±é˜³/å…±é˜´æ•°ç ç®¡é€»è¾‘ï¼š** `duanma` æ•°ç»„ (`0x3f, 0x06...`) æ˜¯å…¸å‹çš„ **å…±é˜´ææ•°ç ç®¡** å­—å½¢ç ï¼ˆ1 ä¸ºäº®ï¼‰ã€‚

- **åŒç«¯å£æ§åˆ¶ï¼š** 

  `P1=duanma[i]`ã€‚

  `P2` è¾“å‡º `~duanma[i]`

#### 3. ç¡¬ä»¶è¿æ¥ (Hardware Wiring)

- **P1 å£** \rightarrow **å…±é˜´ææ•°ç ç®¡æ®µé€‰** (a-dp)ã€‚
- **P2 å£** \rightarrow **å…±é˜³ææ•°ç ç®¡æ®µé€‰** æˆ– **LED é˜µåˆ—** (ç”¨äºæ˜¾ç¤ºåç›¸å›¾æ¡ˆ)ã€‚
- **P3 å£** \rightarrow `0xf8` (11111000)ï¼Œå¯èƒ½è¿æ¥äº†ä½é€‰çº¿ï¼ˆ3-8è¯‘ç å™¨è¾“å…¥ï¼‰æˆ–æ§åˆ¶çº¿ï¼Œé€‰ä¸­ç‰¹å®šçš„æ•°ç ç®¡ä½ç½®ã€‚

#### 4. ä»£ç æ³¨é‡Šè¡¥å…… (Comment Enhancement)

C

```c
// ======= å«æ³¨é‡Šç‰ˆæœ¬ =======
#include<reg52.h>
#include"delay.h" // å¼•ç”¨å¤–éƒ¨å»¶æ—¶å¤´æ–‡ä»¶

#define uint unsigned int

// å…±é˜´ææ•°ç ç®¡æ®µç è¡¨ï¼š0~9, æœ€åä¸€ä¸ª 0x00 æ˜¯ç†„ç­
uint code duanma[] = {0x3f, 0x06, 0x5b, 0x4f, 0x66, 0x6d, 0x7d, 0x07, 0x7f, 0x6f, 0x00};
uint i;

void main()
{
    while(1)
    {
        P3 = 0xf8; // ç«¯å£åˆå§‹åŒ–ï¼Œå¯èƒ½æ˜¯ä½é€‰æˆ–æ§åˆ¶ä¿¡å· (1111 1000)
        
        for(i=0; i<10; i++) // å¾ªç¯æ˜¾ç¤º 0-9
        {
            P1 = duanma[i];      // å°æ•°ç ç®¡æ˜¾ç¤ºi
            P2 = ~duanma[i+1];   // å¤§æ•°ç ç®¡æ˜¾ç¤ºi+1
            delay(1000, 40*4);   
        }
    }
}
```

#### 5. æ’ç‰ˆä¼˜åŒ–åçš„æœ€ç»ˆä»£ç  (Formatted Code)

```c
#include <reg52.h>
#include "delay.h"

#define uint unsigned int

uint code duanma[] = {0x3f, 0x06, 0x5b, 0x4f, 0x66, 0x6d, 0x7d, 0x07, 0x7f, 0x6f, 0x00};
uint i;

void main()
{
    while (1)
    {
        P3 = 0xf8;
        for (i = 0; i < 10; i++)
        {
            P1 = duanma[i];
            P2 = ~duanma[i + 1];
            delay(1000, 40 * 4);
        }
    }
}
```

**æ•°ç ç®¡åŠ¨æ€æ‰«æï¼ˆDynamic Displayï¼‰**

æœ¬æ‰¹æ¬¡åŒ…å« 4 ä¸ªä»£ç ï¼š`09_28_02.c` è‡³ `09_30_01.c`ã€‚

------

### ä»£ç  5ï¼š`09_28_02.c` (æ•°ç ç®¡é€ä½æµ‹è¯•)

#### 1. ä»£ç å®ç°æ•ˆæœ (What it does)

åœ¨ä¸€ä¸ªç®¡å­ä¸Šå¾ªç¯æ˜¾ç¤º0-7åè½¬ç§»åˆ°ä¸‹ä¸€ä¸ªç®¡å­ç»§ç»­æ˜¾ç¤ºï¼Œæ¯ä¸ªå­—ç¬¦0.125ç§’ 

ç¬¬ 1 ä¸ªæ•°ç ç®¡å…ˆä¾æ¬¡æ˜¾ç¤º 0~7ï¼›

ç»“æŸåï¼Œç¬¬ 2 ä¸ªæ•°ç ç®¡ä¾æ¬¡æ˜¾ç¤º 0~7ï¼›

ä»¥æ­¤ç±»æ¨ï¼Œç›´åˆ°ç¬¬ 8 ä¸ªæ•°ç ç®¡æ˜¾ç¤ºå®Œ 0~7ï¼Œç„¶åå¾ªç¯ã€‚

#### 2. å®ç°æ€è·¯ (How it works)

- **åµŒå¥—å¾ªç¯ï¼š**
  - å¤–å±‚å¾ªç¯ `j` æ§åˆ¶ **ä½é€‰**ï¼ˆå“ªä¸€ä¸ªæ•°ç ç®¡äº®ï¼‰ã€‚
  - å†…å±‚å¾ªç¯ `i` æ§åˆ¶ **æ®µé€‰**ï¼ˆæ˜¾ç¤ºä»€ä¹ˆæ•°å­—ï¼‰ã€‚

#### 3. ç¡¬ä»¶è¿æ¥ (Hardware Wiring)

- **P1 å£** æ¥ **æ•°ç ç®¡**
- **P2 å£**ä½ä¸‰ä½ æ¥ **è¯‘ç å™¨**

#### 4. ä»£ç æ³¨é‡Šè¡¥å…… (Comment Enhancement)

```c
// ======= å«æ³¨é‡Šç‰ˆæœ¬ =======
#include<reg52.h>
#include"delay.h"
#define uint unsigned int

// æ®µç è¡¨ï¼šå…±é˜´æ 0~7
uint code duanma[]={0x3f,0x06,0x5b,0x4f,0x66,0x6d,0x7d,0x07};
// ä½é€‰è¡¨ï¼šå¯¹åº” 3-8 è¯‘ç å™¨çš„è¾“å…¥ 000~111ï¼Œåˆ†åˆ«é€‰ä¸­ç¬¬1~8ä¸ªæ•°ç ç®¡
uint code weixuan[]={0x00,0x01,0x02,0x03,0x04,0x05,0x06,0x07};
uint i,j;

void main()
{
    while(1)
    {
        for(j=0;j<8;j++) // å¤–å¾ªç¯ï¼šåˆ‡æ¢æ•°ç ç®¡ä½ç½® (ç¬¬1ä¸ª -> ç¬¬8ä¸ª)
        {
            P2=weixuan[j]; // è¾“å‡ºä½é€‰ä¿¡å·
            for(i=0;i<8;i++) // å†…å¾ªç¯ï¼šåœ¨å½“å‰ä½ç½®ä¾æ¬¡æ˜¾ç¤ºæ•°å­—
            {
                P1=duanma[i];      // è¾“å‡ºæ®µç 
                delay(1000,40/4);  // å»¶æ—¶çº¦ 0.125s
            }
        }
    }
}
```

#### 5. æ’ç‰ˆä¼˜åŒ–åçš„æœ€ç»ˆä»£ç  (Formatted Code)

C

```c
#include <reg52.h>
#include "delay.h"
#define uint unsigned int

uint code duanma[] = {0x3f, 0x06, 0x5b, 0x4f, 0x66, 0x6d, 0x7d, 0x07};
uint code weixuan[] = {0x00, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07};
uint i, j;

void main()
{
    while (1)
    {
        for (j = 0; j < 8; j++)
        {
            P2 = weixuan[j];
            for (i = 0; i < 8; i++)
            {
                P1 = duanma[i];
                delay(1000, 40 / 4);
            }
        }
    }
}
```

------

### ä»£ç  6ï¼š`09_28_03.c` (æ ‡å‡†åŠ¨æ€æ‰«æ)

#### 1. ä»£ç å®ç°æ•ˆæœ (What it does)

èµ°é©¬æ•°ç ï¼Œåœ¨8ä¸ªæ•°ç ç®¡ä¸Šä¾æ¬¡æ˜¾ç¤º0-7ï¼Œæ¯ä¸ªå­—ç¬¦0.25ç§’

8 ä¸ªæ•°ç ç®¡åŒæ—¶æ˜¾ç¤ºï¼ˆè§†è§‰ä¸Šï¼‰ï¼š

ç¬¬ 1 ä½æ˜¾ç¤º 0ï¼Œç¬¬ 2 ä½æ˜¾ç¤º 1 ... ç¬¬ 8 ä½æ˜¾ç¤º 7ã€‚

å±å¹•æ˜¾ç¤ºå†…å®¹ä¸ºï¼šâ€œ0 1 2 3 4 5 6 7â€ã€‚

#### 2. å®ç°æ€è·¯ (How it works)

- **è§†è§‰æš‚ç•™ï¼ˆPersistence of Visionï¼‰ï¼š** åˆ©ç”¨äººçœ¼ç‰¹æ€§ã€‚æ¯ä¸ªæ•°ç ç®¡å®é™…ä¸Šæ˜¯è½®æµç‚¹äº®çš„ï¼Œä½†å› ä¸ºåˆ‡æ¢é€Ÿåº¦æå¿«ï¼ˆæ¯«ç§’çº§ï¼‰ï¼Œçœ‹èµ·æ¥æ‰€æœ‰ç¯éƒ½å¸¸äº®ã€‚

- **æ¶ˆå½±ï¼ˆBlankingï¼‰ï¼š** `P1=0x00`ã€‚åœ¨åˆ‡æ¢ä¸‹ä¸€ä½ä¹‹å‰ï¼Œå¿…é¡»å…ˆæŠŠæ®µé€‰æ¸…é›¶ã€‚å¦åˆ™ï¼Œä¸Šä¸€ä¸ªæ•°å­—çš„ä½™è¾‰ä¼šå‡ºç°åœ¨ä¸‹ä¸€ä¸ªä½ç½®ï¼Œå¯¼è‡´æ˜¾ç¤ºé‡å½±ï¼ˆé¬¼å½±ï¼‰ã€‚

- **æ‰«ææµç¨‹ï¼š**
  $$
  é€‰ä½ \rightarrow é€æ®µç  \rightarrow å¾®å»¶æ—¶ \rightarrow æ¶ˆå½± \rightarrow ä¸‹ä¸€ä½ã€‚
  $$
  

#### 3. ç¡¬ä»¶è¿æ¥ (Hardware Wiring)

- **P1 å£** æ¥ **æ•°ç ç®¡**
- **P2 å£ä½ä¸‰ä½**æ¥**è¯‘ç å™¨**

#### 4. ä»£ç æ³¨é‡Šè¡¥å…… (Comment Enhancement)

```c
// ======= å«æ³¨é‡Šç‰ˆæœ¬ =======
#include<reg52.h>
#include"delay.h"
#define uint unsigned int

uint code duanma[]={0x3f,0x06,0x5b,0x4f,0x66,0x6d,0x7d,0x07};
uint code weixuan[]={0x00,0x01,0x02,0x03,0x04,0x05,0x06,0x07};
uint i;

void main()
{
    while(1)
    {
        for(i=0;i<8;i++) // å¿«é€Ÿè½®è¯¢ 8 ä¸ªä½ç½®
        {
            P2=weixuan[i]; // 1. ä½é€‰ï¼šé€‰ä¸­ç¬¬ i ä¸ªæ•°ç ç®¡
            P1=duanma[i];  // 2. æ®µé€‰ï¼šæ˜¾ç¤ºæ•°å­— i
            
            // 3. æ‰«æå»¶æ—¶ï¼šå¿…é¡»éå¸¸çŸ­ï¼
            // è¿™é‡Œ delay(10, 4) æçŸ­ï¼Œä¿è¯ä¸é—ªçƒ
            delay(1000/100, 40/10); 
            // é—®ï¼šdelayçš„æ—¶é—´çŸ­äº†ï¼Œæ¯ä¸ªæ•°å­—å‘¨å›´éƒ¨åˆ†æœ‰ç‚¹äº®ï¼ˆè§†è§‰æš‚ç•™ï¼‰ã€‚å¦‚ä½•è§£å†³ï¼Ÿ
            // ç­”ï¼šæ¶ˆå½±ã€‚æ·»åŠ ä¸€å¥p1=0x00;
            P1=0x00; // 4. æ¶ˆå½±
        }
    }
}
```

#### 5. æ’ç‰ˆä¼˜åŒ–åçš„æœ€ç»ˆä»£ç  (Formatted Code)

```c
#include <reg52.h>
#include "delay.h"
#define uint unsigned int

uint code duanma[] = {0x3f, 0x06, 0x5b, 0x4f, 0x66, 0x6d, 0x7d, 0x07};
uint code weixuan[] = {0x00, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07};
uint i;

void main()
{
    while (1)
    {
        for (i = 0; i < 8; i++)
        {
            P2 = weixuan[i];
            P1 = duanma[i];
            delay(1000 / 100, 40 / 10);
            P1 = 0x00;
        }
    }
}
```

------

### ä»£ç  7ï¼š`09_28_04.c` (å¤šé¡µåŠ¨æ€æ˜¾ç¤º)

#### 1. ä»£ç å®ç°æ•ˆæœ (What it does)

8 ä¸ªæ•°ç ç®¡è¿›è¡Œç¿»é¡µæ˜¾ç¤ºï¼šåœ¨8ä¸ªæ•°ç ç®¡ä¸ŠåŠ¨æ€æ˜¾ç¤º0-7ï¼Œä½¿å¾—è‚‰çœ¼çœ‹èµ·æ¥8ä¸ªæ•°å­—ä¸€èµ·æ˜¾ç¤º

ç¬¬ 1 é¡µï¼šæ˜¾ç¤ºæ•°ç»„ä¸­ç¬¬ 0-7 ä¸ªæ•°æ®ã€‚

åœç•™çº¦ 1 ç§’å \rightarrow åˆ‡æ¢ç¬¬ 2 é¡µï¼šæ˜¾ç¤ºç¬¬ 8-15 ä¸ªæ•°æ®ã€‚

åœç•™çº¦ 1 ç§’å \rightarrow åˆ‡æ¢ç¬¬ 3 é¡µ... ä¾æ¬¡å¾ªç¯æ˜¾ç¤º 4 é¡µå†…å®¹ã€‚

#### 2. å®ç°æ€è·¯ (How it works)

- **ä¸‰å±‚å¾ªç¯ç»“æ„ï¼š**
  - å¤–å±‚ `j` (0-3)ï¼šæ§åˆ¶â€œé¡µç â€ï¼Œå…± 4 ç»„æ•°æ®ã€‚
  - ä¸­å±‚ `k` (0-1000)ï¼šæ§åˆ¶â€œæ˜¾ç¤ºæ—¶é•¿â€ã€‚å› ä¸ºåŠ¨æ€æ‰«æéœ€è¦åœ¨æçŸ­æ—¶é—´å†…å®Œæˆä¸€æ¬¡ï¼Œä¸ºäº†è®©ç”¨æˆ·çœ‹æ¸…å†…å®¹ï¼Œå¿…é¡»é‡å¤æ‰«æå¾ˆå¤šæ¬¡ï¼ˆå³é‡å¤åˆ·æ–°ç”»é¢ï¼‰ã€‚
  - å†…å±‚ `i` (0-7)ï¼šæ‰§è¡Œå•æ¬¡â€œåŠ¨æ€æ‰«æâ€ï¼Œåˆ·æ–° 8 ä¸ªæ•°ç ç®¡ã€‚
- **æ•°æ®ç´¢å¼•ï¼š** `P0=duanma[i + 8*j]`ã€‚
  - å½“ j=0ï¼Œå– duanma[0]~[7]ã€‚
  - å½“ j=1ï¼Œå– duanma[8]~[15]ã€‚

#### 3. ç¡¬ä»¶è¿æ¥ (Hardware Wiring)

- **P0 å£** \rightarrow **æ•°ç ç®¡æ®µé€‰** (æ³¨æ„è¿™é‡Œå˜æˆäº† P0ï¼Œé€šå¸¸ P0 éœ€è¦ä¸Šæ‹‰ç”µé˜»)ã€‚
- **P2 å£** \rightarrow **æ•°ç ç®¡ä½é€‰**ã€‚

#### 4. ä»£ç æ³¨é‡Šè¡¥å…… (Comment Enhancement)

```
// ======= å«æ³¨é‡Šç‰ˆæœ¬ =======
#include <reg52.h>
#include "delay.h"
#define uint unsigned int

// åŒ…å« 32 ä¸ªæ•°æ®çš„é•¿æ•°ç»„ï¼Œåˆ† 4 é¡µæ˜¾ç¤º
uint code duanma[]={
    0x5b,0x3f,0x5b,0x66, 0x77,0x7c,0x39,0x5e, // ç¬¬1é¡µæ•°æ®
    0x3f,0x3f,0x3f,0x3f, 0x3f,0x3f,0x3f,0x3f, // ç¬¬2é¡µæ•°æ®
    0x06,0x06,0x06,0x06, 0x06,0x06,0x06,0x06, // ç¬¬3é¡µæ•°æ®
    0x4f,0x4f,0x4f,0x4f, 0x4f,0x4f,0x4f,0x4f  // ç¬¬4é¡µæ•°æ®
};  
uint code weixuan[]={0x00,0x01,0x02,0x03,0x04,0x05,0x06,0x07};
uint i,j,k;

void main()
{
    while(1)
    { 
        for(j=0;j<4;j++) // é¡µç å¾ªç¯ï¼šå…±4é¡µ
        {
            // æ˜¾ç¤ºä¿æŒå¾ªç¯ï¼šæ‰§è¡Œ1000æ¬¡æ‰«æï¼Œäº§ç”Ÿè§†è§‰åœç•™æ—¶é—´
            for(k=0;k<1000;k++) 
            {
                for(i=0;i<8;i++) // å•å¸§æ‰«æå¾ªç¯
                {
                    P2=weixuan[i];           // ä½é€‰
                    P0=duanma[i+8*j];        // æ®µé€‰ï¼šåŸºåœ°å€(8*j) + åç§»(i)
                    delay(1000/1000,40);     // çŸ­å»¶æ—¶
                    P0=0x00;                 // æ¶ˆå½±
                }
            }
        }
    }
}
```

#### 5. æ’ç‰ˆä¼˜åŒ–åçš„æœ€ç»ˆä»£ç  (Formatted Code)

C

```
#include <reg52.h>
#include "delay.h"
#define uint unsigned int

uint code duanma[] = {
    0x5b, 0x3f, 0x5b, 0x66, 0x77, 0x7c, 0x39, 0x5e,
    0x3f, 0x3f, 0x3f, 0x3f, 0x3f, 0x3f, 0x3f, 0x3f,
    0x06, 0x06, 0x06, 0x06, 0x06, 0x06, 0x06, 0x06,
    0x4f, 0x4f, 0x4f, 0x4f, 0x4f, 0x4f, 0x4f, 0x4f};
uint code weixuan[] = {0x00, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07};
uint i, j, k;

void main()
{
    while (1)
    {
        for (j = 0; j < 4; j++)
        {
            for (k = 0; k < 1000; k++)
            {
                for (i = 0; i < 8; i++)
                {
                    P2 = weixuan[i];
                    P0 = duanma[i + 8 * j];
                    delay(1000 / 1000, 40);
                    P0 = 0x00;
                }
            }
        }
    }
}
```

------

### ä»£ç  8ï¼š`09_30_01.c` (æŒ‡å®šå†…å®¹çš„åŠ¨æ€æ‰«æ)

#### 1. ä»£ç å®ç°æ•ˆæœ (What it does)

8 ä¸ªæ•°ç ç®¡åŒæ—¶æ˜¾ç¤ºç‰¹å®šçš„ä¸€ä¸²æ•°å­—/å­—ç¬¦ã€‚

æ˜¾ç¤ºå†…å®¹ä¸ºï¼š2 0 2 5 0 9 3 0 (æ ¹æ®æ®µç  5b, 3f, 5b, 6d, 3f, 6f, 4f, 3f æ¨ç®—)ã€‚

æ³¨ï¼šæ¨æµ‹è¿™æ˜¯æ˜¾ç¤ºæ—¥æœŸâ€œ20250930â€ã€‚

#### 2. å®ç°æ€è·¯ (How it works)

- **åŸç†ï¼š** åŒä»£ç  6ï¼ˆæ ‡å‡†åŠ¨æ€æ‰«æï¼‰ã€‚
- **åŒºåˆ«ï¼š** ä»£ç  6 æ˜¯æ˜¾ç¤º `0-7`ï¼Œè¿™é‡Œæ˜¾ç¤ºçš„æ˜¯ `duanma` æ•°ç»„é‡Œè‡ªå®šä¹‰å¥½çš„ 8 ä¸ªç‰¹å®šæ•°å­—ã€‚

#### 3. ç¡¬ä»¶è¿æ¥ (Hardware Wiring)

- **P0 å£** \rightarrow **æ•°ç ç®¡æ®µé€‰**ã€‚
- **P2 å£** \rightarrow **æ•°ç ç®¡ä½é€‰** (3-8 è¯‘ç å™¨)ã€‚

#### 4. ä»£ç æ³¨é‡Šè¡¥å…… (Comment Enhancement)

C

```
// ======= å«æ³¨é‡Šç‰ˆæœ¬ =======
#include<reg52.h>
#include"delay.h"
#define uint unsigned int

// è‡ªå®šä¹‰æ˜¾ç¤ºçš„æ•°å­—åºåˆ—
// 0x5b(2), 0x3f(0), 0x5b(2), 0x6d(5), 0x3f(0), 0x6f(9), 0x4f(3), 0x3f(0)
uint code duanma[]={0x5b,0x3f,0x5b,0x6d,0x3f,0x6f,0x4f,0x3f};
uint code weixuan[]={0x00,0x01,0x02,0x03,0x04,0x05,0x06,0x07};
uint i;

void main()
{
    while(1)
    {
        for(i=0;i<8;i++) // å¾ªç¯æ‰«æ
        {
            P2=weixuan[i];         // é€‰ä½
            P0=duanma[i];          // é€æ®µ
            delay(1000/100,40/10); // çŸ­å»¶æ—¶ (æ‰«æé€Ÿåº¦)
            P0=0x00;               // æ¶ˆå½±
        }
    }
}
```

#### 5. æ’ç‰ˆä¼˜åŒ–åçš„æœ€ç»ˆä»£ç  (Formatted Code)

C

```
#include <reg52.h>
#include "delay.h"
#define uint unsigned int

uint code duanma[] = {0x5b, 0x3f, 0x5b, 0x6d, 0x3f, 0x6f, 0x4f, 0x3f};
uint code weixuan[] = {0x00, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07};
uint i;

void main()
{
    while (1)
    {
        for (i = 0; i < 8; i++)
        {
            P2 = weixuan[i];
            P0 = duanma[i];
            delay(1000 / 100, 40 / 10);
            P0 = 0x00;
        }
    }
}
```

------

æœ¬æ‰¹æ¬¡æ¶µç›–äº† **èœ‚é¸£å™¨é¢‘ç‡æ§åˆ¶**ã€**ç‹¬ç«‹æŒ‰é”®æ£€æµ‹** ä»¥åŠ **LCD1602 æ¶²æ™¶æ˜¾ç¤º** çš„åŸºç¡€åº”ç”¨ã€‚

------

### ä»£ç  9ï¼š`10_10_03.c` (èœ‚é¸£å™¨èŠ‚å¥æ§åˆ¶)

#### 1. ä»£ç å®ç°æ•ˆæœ (What it does)

èœ‚é¸£å™¨å‘å‡ºæœ‰èŠ‚å¥çš„å£°éŸ³åºåˆ—ï¼š

1. **é•¿é¸£**ï¼ˆå“çº¦ 1200 ä¸ªå‘¨æœŸï¼‰ \rightarrow é™éŸ³ã€‚

2. **é•¿é¸£**ï¼ˆå“çº¦ 1200 ä¸ªå‘¨æœŸï¼‰ \rightarrow é™éŸ³ã€‚

3. çŸ­é¸£ï¼ˆå“çº¦ 400 ä¸ªå‘¨æœŸï¼‰ \rightarrow é™éŸ³ã€‚

   å¾ªç¯æ’­æ”¾ç±»ä¼¼â€œå˜€â€”â€” å˜€â€”â€” æ»´â€çš„èŠ‚å¥ã€‚

#### 2. å®ç°æ€è·¯ (How it works)

- **éŸ³é¢‘äº§ç”ŸåŸç†ï¼š** èœ‚é¸£å™¨éœ€è¦è„‰å†²ä¿¡å·é©±åŠ¨ã€‚é€šè¿‡ `fmq = ~fmq` ä¸æ–­å–åé«˜ä½ç”µå¹³ï¼Œäº§ç”Ÿéœ‡åŠ¨æ³¢ã€‚
- **é¢‘ç‡æ§åˆ¶ï¼š** `delay` çš„æ—¶é—´å†³å®šéŸ³è°ƒé«˜ä½ï¼ˆé¢‘ç‡ï¼‰ã€‚æ­¤å¤„å»¶æ—¶å›ºå®šï¼ŒéŸ³è°ƒä¸å˜ã€‚
- **æ—¶é•¿æ§åˆ¶ï¼š** `for` å¾ªç¯çš„æ¬¡æ•°ï¼ˆ`i<1200` æˆ– `i<400`ï¼‰å†³å®šå£°éŸ³æŒç»­çš„æ—¶é—´é•¿åº¦ã€‚

#### 3. ç¡¬ä»¶è¿æ¥ (Hardware Wiring)

- **P1.0** \rightarrow **èœ‚é¸£å™¨** (Active Low/High driverï¼Œé€šå¸¸é€šè¿‡ä¸‰æç®¡é©±åŠ¨)ã€‚

#### 4. ä»£ç æ³¨é‡Šè¡¥å…… (Comment Enhancement)

C

```
// ======= å«æ³¨é‡Šç‰ˆæœ¬ =======
#include <reg52.h>
#include "delay.h"
#define uint unsigned int

sbit fmq = P1^0; // å®šä¹‰èœ‚é¸£å™¨ç«¯å£
uint i;

void main()
{
    while(1)
    {
        // ç¬¬ä¸€é˜¶æ®µï¼šé•¿é¸£
        for(i=0; i<1200; i++)
        {
            fmq = ~fmq; // äº§ç”Ÿæ–¹æ³¢
            delay(1000/1000, 42/2); // å»¶æ—¶å†³å®šé¢‘ç‡ (éŸ³è°ƒ)
        }
        
        // é—´æ­‡
        fmq = 1; // å…³é—­èœ‚é¸£å™¨ (å‡è®¾ä½ç”µå¹³è§¦å‘ï¼Œè¿™é‡Œç½®é«˜ä¸ºç­)
        delay(1000, 42); // é™éŸ³çº¦ 0.5 ç§’

        // ç¬¬äºŒé˜¶æ®µï¼šé•¿é¸£ (åŒä¸Š)
        for(i=0; i<1200; i++)
        {
            fmq = ~fmq;
            delay(1000/1000, 42/2);
        }
        
        // é—´æ­‡
        fmq = 1;
        delay(1000, 42);

        // ç¬¬ä¸‰é˜¶æ®µï¼šçŸ­é¸£ (æ¬¡æ•°é™¤ä»¥3ï¼Œæ—¶é•¿å˜çŸ­)
        for(i=0; i<1200/3; i++)
        {
            fmq = ~fmq;
            delay(1000/1000, 42/2);
        }
        
        // é—´æ­‡
        fmq = 1;
        delay(1000, 42);
    }
}
```

#### 5. æ’ç‰ˆä¼˜åŒ–åçš„æœ€ç»ˆä»£ç  (Formatted Code)

C

```
#include <reg52.h>
#include "delay.h"
#define uint unsigned int

sbit fmq = P1 ^ 0;
uint i;

void main()
{
    while (1)
    {
        // å£°éŸ³æ®µ 1
        for (i = 0; i < 1200; i++)
        {
            fmq = ~fmq;
            delay(1000 / 1000, 42 / 2);
        }
        fmq = 1;
        delay(1000, 42);

        // å£°éŸ³æ®µ 2
        for (i = 0; i < 1200; i++)
        {
            fmq = ~fmq;
            delay(1000 / 1000, 42 / 2);
        }
        fmq = 1;
        delay(1000, 42);

        // å£°éŸ³æ®µ 3
        for (i = 0; i < 1200 / 3; i++)
        {
            fmq = ~fmq;
            delay(1000 / 1000, 42 / 2);
        }
        fmq = 1;
        delay(1000, 42);
    }
}
```

------

### ä»£ç  10ï¼š`10_14_02.c` (ç‹¬ç«‹æŒ‰é”®ç‚¹äº®æ•°ç ç®¡)

#### 1. ä»£ç å®ç°æ•ˆæœ (What it does)

8 ä¸ªç‹¬ç«‹æŒ‰é”®å¯¹åº”æ§åˆ¶ 8 ä¸ªæ•°ç ç®¡ä½ï¼š

æŒ‰ä¸‹ K0 \rightarrow ç¬¬ 0 ä½æ•°ç ç®¡æ˜¾ç¤º '0'ã€‚

æŒ‰ä¸‹ K1 \rightarrow ç¬¬ 1 ä½æ•°ç ç®¡æ˜¾ç¤º '1'ã€‚

...

æŒ‰ä¸‹ K7 \rightarrow ç¬¬ 7 ä½æ•°ç ç®¡æ˜¾ç¤º '7'ã€‚

æ¾å¼€æŒ‰é”®åï¼Œæ˜¾ç¤ºä¿æŒè¿˜æ˜¯æ¶ˆå¤±å–å†³äºä»£ç é€»è¾‘ï¼ˆæ­¤ä»£ç ä¸­ while(!k0) ä¼šå¡æ­»åœ¨æ˜¾ç¤ºçŠ¶æ€ï¼Œæ¾æ‰‹åé€€å‡º ifï¼Œä¸‹ä¸€è½®å¾ªç¯ P0=0x00 ä¼šç†„ç­æ˜¾ç¤ºï¼Œé™¤éä¸€ç›´æŒ‰ç€ï¼‰ã€‚

#### 2. å®ç°æ€è·¯ (How it works)

- **æŒ‰é”®æ¶ˆæŠ–ï¼š** æ£€æµ‹åˆ° `P1!=0xff`ï¼ˆæœ‰é”®æŒ‰ä¸‹ï¼‰åï¼Œå»¶æ—¶çº¦ 20msï¼Œå†æ¬¡æ£€æµ‹ç¡®è®¤ï¼Œæ’é™¤æŠ–åŠ¨å¹²æ‰°ã€‚
- **ä½åˆ¤æ–­ï¼š** ä¾æ¬¡åˆ¤æ–­ `k0` åˆ° `k7` å“ªä¸ªä¸ºä½ç”µå¹³ï¼ˆ0ï¼‰ã€‚
- **æ˜¾ç¤ºé€»è¾‘ï¼š** è®¾ç½®å¯¹åº”çš„ä½é€‰ (`P2`) å’Œæ®µé€‰ (`P0`)ã€‚
- **æ¾æ‰‹æ£€æµ‹ï¼š** `while(!k0);` æ˜¯ä¸€ç§é˜»å¡å†™æ³•ï¼ŒæŒ‰ä½æŒ‰é”®æ—¶ CPU ä¼šä¸€ç›´åœåœ¨è¿™é‡Œç»´æŒæ˜¾ç¤ºï¼Œæ¾æ‰‹åæ‰ç»§ç»­æ‰§è¡Œã€‚

#### 3. ç¡¬ä»¶è¿æ¥ (Hardware Wiring)

- **P1 å£** \rightarrow **8 ä¸ªç‹¬ç«‹æŒ‰é”®** (K0~K7 æ¥åœ°)ã€‚
- **P0 å£** \rightarrow **æ•°ç ç®¡æ®µé€‰**ã€‚
- **P2 å£** \rightarrow **æ•°ç ç®¡ä½é€‰** (3-8 è¯‘ç å™¨)ã€‚

#### 4. ä»£ç æ³¨é‡Šè¡¥å…… (Comment Enhancement)

C

```
// ======= å«æ³¨é‡Šç‰ˆæœ¬ =======
#include<reg52.h>
#include"delay.h"
#define uint unsigned int

// å®šä¹‰æŒ‰é”®ç«¯å£
sbit k0=P1^0; sbit k1=P1^1;
sbit k2=P1^2; sbit k3=P1^3;
sbit k4=P1^4; sbit k5=P1^5;
sbit k6=P1^6; sbit k7=P1^7;

void main()
{
    P0=0x00; // åˆå§‹åŒ–ç­ç¯
    while(1)
    {
        // 1. ç²—æ£€æµ‹ï¼šæ˜¯å¦æœ‰ä»»æ„æŒ‰é”®æŒ‰ä¸‹
        if(P1!=0xff) 
            delay(1000/50,40); // æ¶ˆæŠ–å»¶æ—¶ 20ms

        // 2. ç»†æ£€æµ‹ï¼šç¡®è®¤çœŸçš„æœ‰é”®æŒ‰ä¸‹
        if(P1!=0xff)
        {
            // 3. åˆ¤æ–­å…·ä½“æ˜¯å“ªä¸ªé”®ï¼Œå¹¶æ˜¾ç¤ºå¯¹åº”æ•°å­—
            if(k0==0) { P2=0x00; P0=0x3f; while(!k0); } // æŒ‰ä½K0æ˜¾ç¤º0ï¼Œç›´åˆ°æ¾æ‰‹
            if(k1==0) { P2=0x01; P0=0x06; while(!k1); } // æŒ‰ä½K1æ˜¾ç¤º1
            if(k2==0) { P2=0x02; P0=0x5b; while(!k2); }
            if(k3==0) { P2=0x03; P0=0x4f; while(!k3); }
            if(k4==0) { P2=0x04; P0=0x66; while(!k4); }
            if(k5==0) { P2=0x05; P0=0x6d; while(!k5); }
            if(k6==0) { P2=0x06; P0=0x7d; while(!k6); }
            if(k7==0) { P2=0x07; P0=0x07; while(!k7); }
        }
        
        P0=0x00; // æ¾æ‰‹åç†„ç­
    }
}
```

#### 5. æ’ç‰ˆä¼˜åŒ–åçš„æœ€ç»ˆä»£ç  (Formatted Code)

C

```
#include <reg52.h>
#include "delay.h"
#define uint unsigned int

sbit k0 = P1 ^ 0; sbit k1 = P1 ^ 1;
sbit k2 = P1 ^ 2; sbit k3 = P1 ^ 3;
sbit k4 = P1 ^ 4; sbit k5 = P1 ^ 5;
sbit k6 = P1 ^ 6; sbit k7 = P1 ^ 7;

void main()
{
    P0 = 0x00;
    while (1)
    {
        if (P1 != 0xff)
            delay(1000 / 50, 40);

        if (P1 != 0xff)
        {
            if (k0 == 0) { P2 = 0x00; P0 = 0x3f; while (!k0); }
            if (k1 == 0) { P2 = 0x01; P0 = 0x06; while (!k1); }
            if (k2 == 0) { P2 = 0x02; P0 = 0x5b; while (!k2); }
            if (k3 == 0) { P2 = 0x03; P0 = 0x4f; while (!k3); }
            if (k4 == 0) { P2 = 0x04; P0 = 0x66; while (!k4); }
            if (k5 == 0) { P2 = 0x05; P0 = 0x6d; while (!k5); }
            if (k6 == 0) { P2 = 0x06; P0 = 0x7d; while (!k6); }
            if (k7 == 0) { P2 = 0x07; P0 = 0x07; while (!k7); }
        }
        P0 = 0x00;
    }
}
```

------

### ä»£ç  11ï¼š`10_14_03.c` (æŒ‰é”®è®¡æ•°å™¨ 0-20)

#### 1. ä»£ç å®ç°æ•ˆæœ (What it does)

æ•°ç ç®¡ M6ã€M7 æ˜¾ç¤ºä¸€ä¸ªæ•°å­—å˜é‡ aï¼ˆ00~20ï¼‰ã€‚

æŒ‰ä¸‹ K0 \rightarrow æ•°å­— +1ã€‚

æŒ‰ä¸‹ K7 \rightarrow æ•°å­— -1ã€‚

æ•°å­—åœ¨ [0, 20] åŒºé—´å†…å¾ªç¯ï¼ˆ0 å‡ 1 å˜ 20ï¼Œ20 åŠ  1 å˜ 0ï¼‰ã€‚

#### 2. å®ç°æ€è·¯ (How it works)

- **åŠ¨æ€æ‰«ææ˜¾ç¤ºï¼š** ä¸»å¾ªç¯ä¸­ä¸æ–­åˆ·æ–°æ˜¾ç¤º `a` çš„åä½ (`a/10`) å’Œä¸ªä½ (`a%10`)ã€‚
- **æŒ‰é”®æ’å…¥æ£€æµ‹ï¼š** åœ¨æ˜¾ç¤ºçš„é—´éš™æ£€æµ‹ K0 å’Œ K7ã€‚
- **è¾¹ç•Œå¤„ç†ï¼š**
  - `if(a==21) a=0;` å®ç°ä¸Šé™å¾ªç¯ã€‚
  - `if(a==-1) a=20;` å®ç°ä¸‹é™å¾ªç¯ã€‚
  - *æ³¨æ„ï¼š* `uint` æ˜¯æ— ç¬¦å·æ•´æ•°ï¼Œ0 å‡ 1 ä¼šå˜æˆ 65535ã€‚åœ¨ C è¯­è¨€ä¸­ï¼Œ`(unsigned int)-1` ç­‰äºæœ€å¤§å€¼ï¼Œæ‰€ä»¥é€»è¾‘æ˜¯æˆç«‹çš„ã€‚

#### 3. ç¡¬ä»¶è¿æ¥ (Hardware Wiring)

- **P1.0** \rightarrow **K0** (åŠ é”®)ã€‚
- **P1.7** \rightarrow **K7** (å‡é”®)ã€‚
- **P2 å£** \rightarrow **æ•°ç ç®¡ä½é€‰** (è¿æ¥è¯‘ç å™¨ï¼Œä»£ç ä¸­ç”¨äº† `0x06`, `0x07` é€‰ä¸­æœ€åä¸¤ä½)ã€‚
- **P0 å£** \rightarrow **æ•°ç ç®¡æ®µé€‰**ã€‚

#### 4. ä»£ç æ³¨é‡Šè¡¥å…… (Comment Enhancement)

C

```
// ======= å«æ³¨é‡Šç‰ˆæœ¬ =======
#include<reg52.h>
#include"delay.h"
#define uint unsigned int

uint code duanma[]={0x3f,0x06,0x5b,0x4f,0x66,0x6d,0x7d,0x07,0x7f,0x6f};
uint a;
sbit k0=P1^0;
sbit k7=P1^7;

void main()
{
    a=0; // åˆå§‹å€¼ä¸º0
    while(1)
    {
        // === åŠ¨æ€æ˜¾ç¤ºéƒ¨åˆ† ===
        // æ˜¾ç¤ºåä½ (åœ¨ç¬¬6ä½æ˜¾ç¤º)
        P2=0x06;
        P0=duanma[a/10]; delay(1000/1000,40); P0=0x00;
        // æ˜¾ç¤ºä¸ªä½ (åœ¨ç¬¬7ä½æ˜¾ç¤º)
        P2=0x07;
        P0=duanma[a%10]; delay(1000/1000,40); P0=0x00;
        
        // === æŒ‰é”®æ£€æµ‹éƒ¨åˆ† ===
        // æ£€æµ‹ K0 (åŠ æ³•)
        if(k0==0) 
        {
            delay(1000/50,40); // æ¶ˆæŠ–
            if(k0==0) 
            {
                a++; 
                while(!k0); // ç­‰å¾…æ¾æ‰‹ï¼Œé˜²æ­¢ä¸€æ¬¡æŒ‰ä¸‹è¿åŠ 
            }
        }
        
        // æ£€æµ‹ K7 (å‡æ³•)
        if(k7==0) 
        {
            delay(1000/50,40); 
            if(k7==0) 
            {
                a--; 
                while(!k7); // ç­‰å¾…æ¾æ‰‹
            }
        }

        // === è¾¹ç•Œå¾ªç¯å¤„ç† ===
        if(a==21) a=0;       // è¶…è¿‡20å½’é›¶
        if(a==-1) a=20;      // 0å‡1(ä¸‹æº¢å‡º)å˜20
    }
}
```

#### 5. æ’ç‰ˆä¼˜åŒ–åçš„æœ€ç»ˆä»£ç  (Formatted Code)

C

```
#include <reg52.h>
#include "delay.h"
#define uint unsigned int

uint code duanma[] = {0x3f, 0x06, 0x5b, 0x4f, 0x66, 0x6d, 0x7d, 0x07, 0x7f, 0x6f};
uint a;
sbit k0 = P1 ^ 0;
sbit k7 = P1 ^ 7;

void main()
{
    a = 0;
    while (1)
    {
        // æ˜¾ç¤ºåä½
        P2 = 0x06;
        P0 = duanma[a / 10];
        delay(1000 / 1000, 40);
        P0 = 0x00;

        // æ˜¾ç¤ºä¸ªä½
        P2 = 0x07;
        P0 = duanma[a % 10];
        delay(1000 / 1000, 40);
        P0 = 0x00;

        // K0 æŒ‰é”®å¤„ç†
        if (k0 == 0)
        {
            delay(1000 / 50, 40);
            if (k0 == 0)
            {
                a++;
                while (!k0);
            }
        }

        // K7 æŒ‰é”®å¤„ç†
        if (k7 == 0)
        {
            delay(1000 / 50, 40);
            if (k7 == 0)
            {
                a--;
                while (!k7);
            }
        }

        // è¾¹ç•Œå¤„ç†
        if (a == 21) a = 0;
        if (a == -1) a = 20;
    }
}
```

------

### ä»£ç  12ï¼š`10_14_05.c` (LCD1602 å­—ç¬¦ä¸²æ˜¾ç¤º)

#### 1. ä»£ç å®ç°æ•ˆæœ (What it does)

åœ¨ LCD1602 æ¶²æ™¶å±ä¸Šæ˜¾ç¤ºä¸¤è¡Œå­—ç¬¦ï¼š

ç¬¬ä¸€è¡Œæ˜¾ç¤ºï¼š"HUAINAN SHIYUAN"

ç¬¬äºŒè¡Œæ˜¾ç¤ºï¼š"1111111111ABCDEF"

#### 2. å®ç°æ€è·¯ (How it works)

- **LCD åˆå§‹åŒ–ï¼š** `lcd_ins()` è´Ÿè´£è®¾ç½® LCD çš„å·¥ä½œæ¨¡å¼ï¼ˆæ˜¾ç¤ºå¼€ã€å…‰æ ‡è®¾ç½®ã€æ•°æ®ä½å®½ç­‰ï¼‰ã€‚
- **å†™å‘½ä»¤ (`write_com`)ï¼š**
  - `0x80 + 0x00`ï¼šè®¾ç½®å…‰æ ‡åœ°å€åˆ°ç¬¬ä¸€è¡Œå¼€å¤´ã€‚
  - `0x80 + 0x40`ï¼šè®¾ç½®å…‰æ ‡åœ°å€åˆ°ç¬¬äºŒè¡Œå¼€å¤´ã€‚
- **å†™æ•°æ® (`write_dat`)ï¼š** å°†å­—ç¬¦æ•°ç»„ `s0` å’Œ `s1` ä¸­çš„ ASCII ç é€ä¸ªå‘é€ç»™ LCD æ˜¾ç¤ºã€‚

#### 3. ç¡¬ä»¶è¿æ¥ (Hardware Wiring)

- **P0 å£** \rightarrow **LCD D0~D7 æ•°æ®çº¿**ã€‚
- **P2.5** \rightarrow **RW** (è¯»å†™é€‰æ‹©ï¼Œé€šå¸¸æ¥åœ°æˆ–ç”±ç¨‹åºæ§åˆ¶)ã€‚
- **P2.6** \rightarrow **RS** (å¯„å­˜å™¨é€‰æ‹©ï¼šé«˜ç”µå¹³æ•°æ®/ä½ç”µå¹³å‘½ä»¤)ã€‚
- **P2.7** \rightarrow **EN** (ä½¿èƒ½ç«¯ï¼Œä¸‹é™æ²¿æ‰§è¡Œ)ã€‚

#### 4. ä»£ç æ³¨é‡Šè¡¥å…… (Comment Enhancement)

C

```
// ======= å«æ³¨é‡Šç‰ˆæœ¬ =======
#include<reg52.h>
#include"delay.h"
#include"lcd.h" // å¼•ç”¨LCDé©±åŠ¨å¤´æ–‡ä»¶

#define uint unsigned int
#define uchar unsigned char

// å®šä¹‰LCDæ§åˆ¶å¼•è„š
sbit lcdwr=P2^5;
sbit lcdrs=P2^6;
sbit lcden=P2^7;

// å®šä¹‰æ˜¾ç¤ºå†…å®¹çš„å­—ç¬¦ä¸²
uchar code s0[]="HUAINAN  SHIYUAN";
uchar code s1[]="1111111111ABCDEF";
uint i;

void main()
{
    lcd_ins(); // LCD åˆå§‹åŒ–åºåˆ—

    // --- å†™ç¬¬ä¸€è¡Œ ---
    write_com(0x80+0x00); // è®¾å®šå…‰æ ‡ä½ç½®ï¼šç¬¬1è¡Œç¬¬1åˆ—
    for(i=0;i<16;i++)
    {
        write_dat(s0[i]); // å†™å…¥æ•°æ®
        delay(1000,40);   // ç¨ä½œå»¶æ—¶ï¼Œé€ æˆæ‰“å­—æœºæ•ˆæœï¼ˆå¯é€‰ï¼‰
    }

    // --- å†™ç¬¬äºŒè¡Œ ---
    write_com(0x80+0x40); // è®¾å®šå…‰æ ‡ä½ç½®ï¼šç¬¬2è¡Œç¬¬1åˆ—
    for(i=0;i<16;i++)
    {
        write_dat(s1[i]);
        delay(1000,40);
    }
    
    while(1); // ç¨‹åºç»“æŸï¼Œæ­»å¾ªç¯ä¿æŒæ˜¾ç¤º
}
```

#### 5. æ’ç‰ˆä¼˜åŒ–åçš„æœ€ç»ˆä»£ç  (Formatted Code)

C

```
#include <reg52.h>
#include "delay.h"
#include "lcd.h"
#define uint unsigned int
#define uchar unsigned char

sbit lcdwr = P2 ^ 5;
sbit lcdrs = P2 ^ 6;
sbit lcden = P2 ^ 7;

uchar code s0[] = "HUAINAN  SHIYUAN";
uchar code s1[] = "1111111111ABCDEF";
uint i;

void main()
{
    lcd_ins();

    write_com(0x80 + 0x00);
    for (i = 0; i < 16; i++)
    {
        write_dat(s0[i]);
        delay(1000, 40);
    }

    write_com(0x80 + 0x40);
    for (i = 0; i < 16; i++)
    {
        write_dat(s1[i]);
        delay(1000, 40);
    }

    while (1);
}
```

------

æ”¶åˆ°ï¼Œè¿™æ˜¯ç¬¬å››æ‰¹ä»£ç è§£æã€‚

è¿™ä¸€æ‰¹ä»£ç æ ‡å¿—ç€è¯¾ç¨‹éš¾åº¦çš„**åˆ†æ°´å²­**ã€‚æˆ‘ä»¬å¼€å§‹è¿›å…¥ **ä¸­æ–­ç³»ç»Ÿ (Interrupts)** çš„æ ¸å¿ƒå†…å®¹ã€‚è¿™æ˜¯å•ç‰‡æœºæœ€å¼ºå¤§çš„åŠŸèƒ½ä¹‹ä¸€ï¼Œä¹Ÿæ˜¯æœŸæœ«è€ƒè¯•ä¸­åŒºåˆ†â€œåŠæ ¼â€ä¸â€œé«˜åˆ†â€çš„å…³é”®ç‚¹ã€‚

æœ¬æ‰¹æ¬¡åŒ…å« 3 ä¸ªä»£ç ï¼š`10_28_01.c`ï¼ˆLCD è¿›é˜¶ï¼‰ä»¥åŠ `11_04_01.c` å’Œ `11_04_02.c`ï¼ˆå¤–éƒ¨ä¸­æ–­æ§åˆ¶ï¼‰ã€‚

------

### ä»£ç  13ï¼š`10_28_01.c` (LCD1602 ç§»ä½ä¸æ¸…å±)

#### 1. ä»£ç å®ç°æ•ˆæœ (What it does)

LCD1602 æ˜¾ç¤ºå¹¶è¿›è¡ŒåŠ¨æ€æ“ä½œï¼š

1. **æ˜¾ç¤º**ï¼šç¬¬ä¸€è¡Œæ˜¾ç¤º "HUAINAN SHIYUAN"ï¼Œç¬¬äºŒè¡Œæ˜¾ç¤º "0123...F"ã€‚
2. **ç§»ä½**ï¼šæ•´å±å†…å®¹å‘å·¦ç§»åŠ¨ 16 æ¬¡ï¼ˆé€ æˆå­—å¹•æ»šåŠ¨çš„è§†è§‰æ•ˆæœï¼‰ã€‚
3. **æ¸…å±**ï¼šæš‚åœç‰‡åˆ»åï¼Œæ¸…ç©ºå±å¹•æ‰€æœ‰å†…å®¹ã€‚
4. **å¾ªç¯**ï¼šé‡æ–°æ˜¾ç¤ºã€ç§»ä½ã€æ¸…å±ã€‚

#### 2. å®ç°æ€è·¯ (How it works)

- **æŒ‡ä»¤æ§åˆ¶ï¼š**
  - `write_com(0x18)`ï¼šè¿™æ˜¯ LCD1602 çš„æ ‡å‡†æŒ‡ä»¤â€œæ•´å±å·¦ç§»â€ã€‚å¾ªç¯æ‰§è¡Œ 16 æ¬¡ï¼Œåˆšå¥½æŠŠåŸæœ¬æ˜¾ç¤ºåœ¨å±å¹•ä¸Šçš„ 16 ä¸ªå­—ç¬¦ç§»å‡ºæ˜¾ç¤ºåŒºã€‚
  - `write_com(0x01)`ï¼šæ ‡å‡†æŒ‡ä»¤â€œæ¸…å±â€ï¼Œæ¸…é™¤ DDRAM å†…å®¹å¹¶å…‰æ ‡å¤ä½ã€‚
- **æ—¶åºæ§åˆ¶ï¼š** åœ¨ç§»ä½å’Œæ¸…å±ä¹‹é—´åŠ å…¥äº†é•¿å»¶æ—¶ `delay(1000*6, 40)`ï¼Œè®©äººçœ¼èƒ½çœ‹æ¸…å½“å‰çŠ¶æ€ã€‚

#### 3. ç¡¬ä»¶è¿æ¥ (Hardware Wiring)

- **P0 å£** \rightarrow **LCD D0~D7 æ•°æ®çº¿**ã€‚
- **P2.5/6/7** \rightarrow **LCD æ§åˆ¶çº¿ (WR, RS, EN)**ã€‚

#### 4. ä»£ç æ³¨é‡Šè¡¥å…… (Comment Enhancement)

C

```
// ======= å«æ³¨é‡Šç‰ˆæœ¬ =======
#include<reg52.h>
#include"delay.h"
#include"lcds1.h" // å‡è®¾è¿™æ˜¯åŒ…å«äº† lcd_ins, write_com, write_dat çš„å¤´æ–‡ä»¶

#define uint unsigned int
#define uchar unsigned char

uchar code s0[]="HUAINAN  SHIYUAN";
uchar code s1[]="0123456789ABCDEF";
uint i,j;

void main()
{
    lcd_ins(); // åˆå§‹åŒ–
    while(1)
    {
        // --- 1. å†™å…¥åˆå§‹å†…å®¹ ---
        write_com(0x80+0x10); // è®¾ç½®èµ·å§‹åœ°å€åœ¨å±å¹•å³ä¾§å¤–éƒ¨ï¼ˆæˆ–æ ¹æ®å…·ä½“å¤´æ–‡ä»¶é€»è¾‘ï¼Œé€šå¸¸æ˜¯0x80ï¼‰
                              // åŸä»£ç  0x80+0x10 æ„ä¸ºä»ç¬¬ä¸€è¡Œç¬¬17ä¸ªä½ç½®å¼€å§‹å†™ï¼ˆå±å¹•å¤–ï¼‰ï¼Œé…åˆåç»­ç§»ä½è¿›å…¥
        for(i=0;i<16;i++)
        {
            write_dat(s0[i]);
            delay(1000/100,40);
        }

        write_com(0x80+0x50); // ç¬¬äºŒè¡Œèµ·å§‹åœ°å€
        for(j=0;j<16;j++)
        {
            write_dat(s1[j]);
            delay(1000/100,40);
        }

        // --- 2. æ»šå±æ“ä½œ ---
        for(j=0;j<16;j++)
        {
            write_com(0x18); // 0x18: æ•´å±å·¦ç§»æŒ‡ä»¤
            delay(1000,40);  // ç§»åŠ¨é€Ÿåº¦
        }

        // --- 3. åœç•™å±•ç¤º ---
        delay(1000*6,40); // åœç•™çº¦ 3 ç§’
        
        // --- 4. æ¸…å± ---
        write_com(0x01);  // 0x01: æ¸…å±æŒ‡ä»¤
        
        delay(1000*6,40); // ç©ºç™½åœç•™
    }   
}
```

#### 5. æ’ç‰ˆä¼˜åŒ–åçš„æœ€ç»ˆä»£ç  (Formatted Code)

C

```
#include <reg52.h>
#include "delay.h"
#include "lcds1.h"
#define uint unsigned int
#define uchar unsigned char

uchar code s0[] = "HUAINAN  SHIYUAN";
uchar code s1[] = "0123456789ABCDEF";
uint i, j;

void main()
{
    lcd_ins();
    while (1)
    {
        write_com(0x80 + 0x10);
        for (i = 0; i < 16; i++)
        {
            write_dat(s0[i]);
            delay(1000 / 100, 40);
        }

        write_com(0x80 + 0x50);
        for (j = 0; j < 16; j++)
        {
            write_dat(s1[j]);
            delay(1000 / 100, 40);
        }

        for (j = 0; j < 16; j++)
        {
            write_com(0x18);
            delay(1000, 40);
        }

        delay(1000 * 6, 40);

        write_com(0x01);

        delay(1000 * 6, 40);
    }
}
```

------

### ä»£ç  14ï¼š`11_04_01.c` (å¤–éƒ¨ä¸­æ–­åŸºç¡€ä¸ä¼˜å…ˆçº§)

#### 1. ä»£ç å®ç°æ•ˆæœ (What it does)

ä¸»ç¨‹åºï¼š æ•°ç ç®¡å¾ªç¯æ˜¾ç¤º 0~7ï¼ˆæ­¤æ—¶èœ‚é¸£å™¨ä¸å“ï¼‰ã€‚

å¤–éƒ¨ä¸­æ–­ 0 (INT0)ï¼š è§¦å‘æ—¶ï¼Œèœ‚é¸£å™¨ç¿»è½¬ä¸€æ¬¡ï¼ˆå“ä¸€ä¸‹ï¼‰ï¼Œç„¶åç«‹å³è¿”å›ä¸»ç¨‹åºã€‚

å¤–éƒ¨ä¸­æ–­ 1 (INT1)ï¼š è§¦å‘æ—¶ï¼Œèœ‚é¸£å™¨å‘å‡ºé•¿é¸£ï¼ˆå“ 600 ä¸ªå‘¨æœŸï¼‰ï¼Œæ­¤æ—¶æ•°ç ç®¡åœæ­¢æ‰«æï¼ˆä¿æŒæŸä¸€æ•°å­—ï¼‰ã€‚

ä¼˜å…ˆçº§æ¼”ç¤ºï¼š INT1 è¢«è®¾ç½®ä¸ºé«˜ä¼˜å…ˆçº§ã€‚å¦‚æœåœ¨æ‰§è¡Œ INT0 æ—¶è§¦å‘ INT1ï¼Œä¼šç«‹å³è·³è½¬å»æ‰§è¡Œ INT1ï¼ˆä¸­æ–­åµŒå¥—ï¼‰ã€‚

#### 2. å®ç°æ€è·¯ (How it works)

- **ä¸­æ–­é…ç½®ï¼š**
  - `EA=1`ï¼šå¼€å¯æ€»ä¸­æ–­ã€‚
  - `EX0=1` / `EX1=1`ï¼šå¼€å¯å¤–éƒ¨ä¸­æ–­ 0 å’Œ 1ã€‚
  - `IT0=0` / `IT1=0`ï¼šè®¾ç½®ä¸º**ä½ç”µå¹³è§¦å‘**ï¼ˆæŒ‰ä½æŒ‰é”®ä¼šæŒç»­è§¦å‘ï¼Œç›´åˆ°æ¾æ‰‹æˆ–æ‰‹åŠ¨å…³é—­ä¸­æ–­ä½ï¼‰ã€‚
  - `PX1=1`ï¼š**å…³é”®ç‚¹**ã€‚å°†å¤–éƒ¨ä¸­æ–­ 1 è®¾ç½®ä¸º**é«˜ä¼˜å…ˆçº§**ã€‚
- **ä¸­æ–­æœåŠ¡å‡½æ•° (ISR)ï¼š**
  - `interrupt 0` å¯¹åº” INT0ã€‚
  - `interrupt 2` å¯¹åº” INT1ã€‚
  - è¿›å…¥ä¸­æ–­åï¼Œé€šå¸¸å…ˆ `EX0=0` å…³é—­ä¸­æ–­é˜²æ­¢é‡å…¥ï¼ˆå¦‚æœä¸éœ€è¦åµŒå¥—ï¼‰ï¼Œå¤„ç†å®Œåå† `EX0=1` æ‰“å¼€ã€‚

#### 3. ç¡¬ä»¶è¿æ¥ (Hardware Wiring)

- **P1.0** \rightarrow **èœ‚é¸£å™¨**ã€‚
- **P3.2 (INT0)** \rightarrow **æŒ‰é”® K1** (è§¦å‘ INT0)ã€‚
- **P3.3 (INT1)** \rightarrow **æŒ‰é”® K8** (è§¦å‘ INT1)ã€‚
- **P0/P2** \rightarrow **æ•°ç ç®¡**ã€‚

#### 4. ä»£ç æ³¨é‡Šè¡¥å…… (Comment Enhancement)

C

```
// ======= å«æ³¨é‡Šç‰ˆæœ¬ =======
#include<reg52.h>
#include"delay.h"
#define uint unsigned int

uint code duanma[]={0x3f,0x06,0x5b,0x4f,0x66,0x6d,0x7d,0x07};
uint code weixuan[]={0x00,0x01,0x02,0x03,0x04,0x05,0x06,0x07};
sbit fmq=P1^0;
uint i,j;

void main()
{
    // --- ä¸­æ–­åˆå§‹åŒ– ---
    IT0=0; EX0=1; // INT0: ä½ç”µå¹³è§¦å‘, å…è®¸ä¸­æ–­
    IT1=0; EX1=1; // INT1: ä½ç”µå¹³è§¦å‘, å…è®¸ä¸­æ–­
    PX1=1;        // ä¼˜å…ˆçº§è®¾ç½®: INT1 è®¾ä¸ºé«˜ä¼˜å…ˆçº§ (å¯æ‰“æ–­ INT0)
    EA=1;         // æ‰“å¼€æ€»ä¸­æ–­å¼€å…³
    
    while(1)
    {
        // ä¸»å¾ªç¯ï¼šæ­£å¸¸æ‰«ææ•°ç ç®¡
        for(i=0;i<8;i++)
        {
            P2=weixuan[i];
            P0=duanma[i];
            delay(1000,40);
            P0=0x00;
        }
    }
}

// å¤–éƒ¨ä¸­æ–­0 æœåŠ¡å‡½æ•°
void ex0_int() interrupt 0
{
    EX0=0; // æš‚æ—¶å…³é—­ INT0ï¼Œé˜²æ­¢æŒ‰é”®æŠ–åŠ¨å¯¼è‡´é‡å¤è¿›å…¥
    
    fmq=~fmq; // èœ‚é¸£å™¨çŠ¶æ€ç¿»è½¬
    delay(1000/1000,40); 
    
    EX0=1; // æ¢å¤ INT0
}

// å¤–éƒ¨ä¸­æ–­1 æœåŠ¡å‡½æ•°
void ex1_int() interrupt 2
{
    EX1=0; // æš‚æ—¶å…³é—­ INT1

    // æ‰§è¡Œä¸€æ®µè¾ƒé•¿çš„èœ‚é¸£å™¨é¸£å«
    for(j=0;j<600;j++)
    {
        fmq=~fmq;
        delay(1000/500,42/3);
    }
    
    fmq=0; // ç¡®ä¿ç»“æŸæ—¶èœ‚é¸£å™¨çŠ¶æ€ï¼ˆå‡è®¾0ä¸ºå…³é—­/æ‰“å¼€è§†ç¡¬ä»¶è€Œå®šï¼‰
    delay(1000,40);

    EX1=1; // æ¢å¤ INT1
}
```

#### 5. æ’ç‰ˆä¼˜åŒ–åçš„æœ€ç»ˆä»£ç  (Formatted Code)

C

```
#include <reg52.h>
#include "delay.h"
#define uint unsigned int

uint code duanma[] = {0x3f, 0x06, 0x5b, 0x4f, 0x66, 0x6d, 0x7d, 0x07};
uint code weixuan[] = {0x00, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07};
sbit fmq = P1 ^ 0;
uint i, j;

void main()
{
    IT0 = 0; EX0 = 1; EA = 1;
    IT1 = 0; EX1 = 1; PX1 = 1;
    while (1)
    {
        for (i = 0; i < 8; i++)
        {
            P2 = weixuan[i];
            P0 = duanma[i];
            delay(1000, 40);
            P0 = 0x00;
        }
    }
}

void ex0_int() interrupt 0
{
    EX0 = 0;
    fmq = ~fmq;
    delay(1000 / 1000, 40);
    EX0 = 1;
}

void ex1_int() interrupt 2
{
    EX1 = 0;
    for (j = 0; j < 600; j++)
    {
        fmq = ~fmq;
        delay(1000 / 500, 42 / 3);
    }
    fmq = 0;
    delay(1000, 40);
    EX1 = 1;
}
```

------

### ä»£ç  15ï¼š`11_04_02.c` (ä¸­æ–­é˜»å¡ä¸ç­‰å¾…)

#### 1. ä»£ç å®ç°æ•ˆæœ (What it does)

ä¸»ç¨‹åºï¼š èœ‚é¸£å™¨æŒç»­é¸£å«ï¼ˆæŠ¥è­¦çŠ¶æ€ï¼‰ã€‚

å¤–éƒ¨ä¸­æ–­ 0ï¼š æŒ‰ä¸‹ K1 è§¦å‘ã€‚

- æ•°ç ç®¡ P0 æ˜¾ç¤ºæ•°å­— '0'ã€‚

- èœ‚é¸£å™¨åœæ­¢é¸£å«ã€‚

- é˜»å¡ç­‰å¾…ï¼šç¨‹åºä¼šåœåœ¨è¿™é‡Œï¼Œç›´åˆ° K1 æ¾å¼€ã€‚æ¾å¼€åè¿”å›ä¸»ç¨‹åºï¼ˆèœ‚é¸£å™¨ç»§ç»­å«ï¼‰ã€‚

  å¤–éƒ¨ä¸­æ–­ 1ï¼š æŒ‰ä¸‹ K8 è§¦å‘ã€‚

- æ•°ç ç®¡ P0 æ˜¾ç¤ºæ•°å­— '1'ã€‚

- èœ‚é¸£å™¨åœæ­¢ã€‚

- **é˜»å¡ç­‰å¾…**ï¼šç›´åˆ° K8 æ¾å¼€ã€‚

#### 2. å®ç°æ€è·¯ (How it works)

- **ä¸­æ–­ä½œä¸ºâ€œæš‚åœé”®â€ï¼š** åˆ©ç”¨ä¸­æ–­çš„é«˜ä¼˜å…ˆçº§ç‰¹æ€§ï¼Œæ‰“æ–­ä¸»ç¨‹åºçš„ `while(1)` å¾ªç¯ã€‚
- **`while(!k1)` æœºåˆ¶ï¼š** åœ¨ä¸­æ–­æœåŠ¡å‡½æ•°å†…éƒ¨ä½¿ç”¨ `while(!k1)`ã€‚å› ä¸ºæ˜¯ä½ç”µå¹³è§¦å‘ï¼ˆ`IT0=0`ï¼‰ï¼Œå¦‚æœä¸ç­‰å¾…æ¾æ‰‹ï¼Œä¸­æ–­ç»“æŸåå› ä¸ºç”µå¹³ä»ä¸ºä½ï¼Œä¼šç«‹åˆ»å†æ¬¡è§¦å‘ä¸­æ–­ã€‚è¿™é‡Œæ—¢èµ·åˆ°äº†é˜²æ­¢é‡å¤è§¦å‘çš„ä½œç”¨ï¼Œä¹Ÿèµ·åˆ°äº†â€œæŒ‰ä½æ˜¾ç¤ºï¼Œæ¾æ‰‹æ¶ˆå¤±â€çš„åŠŸèƒ½ã€‚

#### 3. ç¡¬ä»¶è¿æ¥ (Hardware Wiring)

- **P1.0** \rightarrow **èœ‚é¸£å™¨**ã€‚
- **P3.2 (INT0)** \rightarrow **æŒ‰é”® K1**ã€‚
- **P3.3 (INT1)** \rightarrow **æŒ‰é”® K8**ã€‚
- **P0** \rightarrow **æ•°ç ç®¡æ®µé€‰** (å…±é˜´æï¼Œ`~0x3f` å–ååå¦‚æœæ˜¯å…±é˜³æ¥æ³•éœ€è¦æ³¨æ„ï¼Œè¿™é‡Œä»£ç å†™ `~0x3f`ï¼Œæ¨æµ‹å¯èƒ½æ˜¯å…±é˜³æ•°ç ç®¡æˆ–è€…ä¸ºäº†æ˜¾ç¤ºå–åæ•ˆæœ)ã€‚

#### 4. ä»£ç æ³¨é‡Šè¡¥å…… (Comment Enhancement)

C

```
// ======= å«æ³¨é‡Šç‰ˆæœ¬ =======
#include<reg52.h>
#include"delay.h"

sbit fmq=P1^0; 
sbit k1=P3^2; // å¯¹åº” INT0 å¼•è„š
sbit k8=P3^3; // å¯¹åº” INT1 å¼•è„š

void main()
{
    EA=1;        // æ€»ä¸­æ–­å¼€
    IT0=0; EX0=1;// INT0 ä½ç”µå¹³è§¦å‘
    IT1=0; EX1=1;// INT1 ä½ç”µå¹³è§¦å‘
    
    while(1)
    {
        // ä¸»å¾ªç¯ï¼šèœ‚é¸£å™¨æŒç»­å‘å£°
        fmq=~fmq;
        delay(1000/500,42/3);
    }
}

// INT0 ä¸­æ–­å¤„ç†
void ex0_int() interrupt 0
{
    // è¿›å…¥ä¸­æ–­ï¼Œä¸»ç¨‹åºæš‚åœ
    P0 = ~0x3f; // æ˜¾ç¤º '0' (å–åç )
    fmq = 0;    // å¼ºåˆ¶å…³é—­èœ‚é¸£å™¨
    
    while(!k1); // æ­»å¾ªç¯ç­‰å¾…ï¼šåªè¦æŒ‰é”®ä¸æ¾å¼€ï¼Œå°±ä¸€ç›´åœåœ¨è¿™
    
    P0 = ~0x00; // æ¾æ‰‹åï¼Œç†„ç­æ•°ç ç®¡
}

// INT1 ä¸­æ–­å¤„ç†
void ex1_int() interrupt 2
{
    P0 = ~0x06; // æ˜¾ç¤º '1'
    fmq = 0;
    
    while(!k8); // ç­‰å¾… K8 æ¾æ‰‹
    
    P0 = ~0x00;
}
```

#### 5. æ’ç‰ˆä¼˜åŒ–åçš„æœ€ç»ˆä»£ç  (Formatted Code)

C

```
#include <reg52.h>
#include "delay.h"

sbit fmq = P1 ^ 0;
sbit k1 = P3 ^ 2;
sbit k8 = P3 ^ 3;

void main()
{
    EA = 1;
    IT0 = 0; EX0 = 1;
    IT1 = 0; EX1 = 1;
    while (1)
    {
        fmq = ~fmq;
        delay(1000 / 500, 42 / 3);
    }
}

void ex0_int() interrupt 0
{
    P0 = ~0x3f;
    fmq = 0;
    while (!k1);
    P0 = ~0x00;
}

void ex1_int() interrupt 2
{
    P0 = ~0x06;
    fmq = 0;
    while (!k8);
    P0 = ~0x00;
}
```

------



æ”¶åˆ°ï¼Œè¿™æ˜¯æœ€åä¸€æ‰¹ï¼Œä¹Ÿæ˜¯**å«é‡‘é‡æœ€é«˜**çš„ä»£ç è§£æã€‚è¿™éƒ¨åˆ†å†…å®¹æ¶‰åŠ**å®šæ—¶å™¨ï¼ˆTimerï¼‰ä¸ä¸­æ–­çš„ååŒå·¥ä½œ**ï¼Œé€šå¸¸å¯¹åº”æœŸæœ«è€ƒè¯•æœ€åä¸€é“å‹è½´å¤§é¢˜ï¼ˆè®¾è®¡ç”µå­é’Ÿæˆ–ç§’è¡¨ï¼‰ã€‚

æœ¬æ‰¹æ¬¡åŒ…å« 2 ä¸ªä»£ç ï¼š`11_11_01.c`ï¼ˆåŒå®šæ—¶å™¨ç®€æ˜“æ—¶é’Ÿï¼‰å’Œ `11_14_01.c`ï¼ˆå¯æš‚åœ/å¤ä½ç§’è¡¨ï¼‰ã€‚

------

### ä»£ç  16ï¼š`11_11_01.c` (åŒå®šæ—¶å™¨ç”µå­é’Ÿ)

#### 1. ä»£ç å®ç°æ•ˆæœ (What it does)

ä¸€ä¸ªç®€æ˜“çš„åˆ†é’Ÿ/ç§’é’Ÿè®¡æ•°å™¨ï¼Œæ ¼å¼ä¸º `MM-SS`ï¼š

- **æ•°ç ç®¡æ˜¾ç¤º**ï¼šå·¦è¾¹ä¸¤ä½æ˜¾ç¤ºâ€œåˆ†é’Ÿâ€ï¼Œä¸­é—´æ˜¾ç¤ºæ¨ªæ â€œ-â€ï¼Œå³è¾¹ä¸¤ä½æ˜¾ç¤ºâ€œç§’é’Ÿâ€ã€‚
- **è®¡æ—¶é€»è¾‘**ï¼š
  - â€œç§’â€ç”±å®šæ—¶å™¨ T0 æ§åˆ¶ï¼Œæ¯ç§’è‡ªåŠ¨åŠ  1ï¼Œåˆ° 60 å½’é›¶ã€‚
  - â€œåˆ†â€ç”±å®šæ—¶å™¨ T1 **ç‹¬ç«‹æ§åˆ¶**ï¼Œæ¯åˆ†é’Ÿè‡ªåŠ¨åŠ  1ï¼Œåˆ° 60 å½’é›¶ã€‚
- *æ³¨æ„ï¼šæ­¤ä»£ç ä½¿ç”¨äº†ä¸¤ä¸ªç‹¬ç«‹çš„å®šæ—¶å™¨åˆ†åˆ«è®¡ç®—ç§’å’Œåˆ†ï¼Œè¿™æ˜¯ä¸€ç§éå…¸å‹çš„å†™æ³•ï¼ˆé€šå¸¸æ˜¯ç”¨ç§’è¿›ä½æ§åˆ¶åˆ†ï¼‰ï¼Œä½†é€»è¾‘ä¸Šèƒ½å®ç°æ•ˆæœã€‚*

#### 2. å®ç°æ€è·¯ (How it works)

- **å®šæ—¶å™¨é…ç½® (`TMOD=0x11`)**ï¼š
  - T0 å’Œ T1 éƒ½å·¥ä½œåœ¨ **æ¨¡å¼ 1**ï¼ˆ16ä½å®šæ—¶å™¨æ¨¡å¼ï¼‰ã€‚
- **åˆå€¼è®¡ç®—**ï¼š
  - `(65536 - 50000)`ï¼šå®šæ—¶ 50msã€‚
  - T0 ä¸­æ–­ï¼šæ¯ 50ms è¿›å…¥ä¸€æ¬¡ï¼Œè®¡æ•° 20 æ¬¡ = 1ç§’ \rightarrow `sum1++`ã€‚
  - T1 ä¸­æ–­ï¼šæ¯ 50ms è¿›å…¥ä¸€æ¬¡ï¼Œè®¡æ•° 1200 æ¬¡ = 60ç§’ï¼ˆ1åˆ†é’Ÿï¼‰ \rightarrow `sum2++`ã€‚
- **æ˜¾ç¤ºé€»è¾‘**ï¼šä¸»å¾ªç¯ä¸æ–­æ‰«æ 5 ä¸ªä½ç½®ï¼ˆåˆ†åã€åˆ†ä¸ªã€æ¨ªæ ã€ç§’åã€ç§’ä¸ªï¼‰ã€‚

#### 3. ç¡¬ä»¶è¿æ¥ (Hardware Wiring)

- **P0 å£** \rightarrow **æ•°ç ç®¡æ®µé€‰**ã€‚
- **P2 å£** \rightarrow **æ•°ç ç®¡ä½é€‰** (è¿æ¥è¯‘ç å™¨ï¼Œç”¨åˆ° 2,3,4,5,6 é€šé“)ã€‚
  - P2=0x02/0x03ï¼šæ˜¾ç¤ºåˆ†é’Ÿã€‚
  - P2=0x04ï¼šæ˜¾ç¤ºæ¨ªæ  (`0x40` æ˜¯å…±é˜´æçš„æ¨ªæ ç )ã€‚
  - P2=0x05/0x06ï¼šæ˜¾ç¤ºç§’é’Ÿã€‚

#### 4. ä»£ç æ³¨é‡Šè¡¥å…… (Comment Enhancement)

C

```
// ======= å«æ³¨é‡Šç‰ˆæœ¬ =======
#include<reg52.h>
#include"delay.h"
#define uint unsigned int

uint code duanma[]={0x3f,0x06,0x5b,0x4f,0x66,0x6d,0x7d,0x07,0x7f,0x6f};
uint sum00,sum01,sum1,sum2;

void main()
{
    // TMOD é…ç½®ï¼šT1(é«˜4ä½)æ¨¡å¼1ï¼ŒT0(ä½4ä½)æ¨¡å¼1 => 0001 0001
    TMOD=0x11;
    
    // T0 åˆå§‹åŒ–ï¼š50ms
    TH0=(65536-50000)/256;
    TL0=(65536-50000)%256;
    EA=1; ET0=1; TR0=1; // å¼€æ€»ä¸­æ–­ï¼Œå¼€T0ä¸­æ–­ï¼Œå¯åŠ¨T0
    
    // T1 åˆå§‹åŒ–ï¼š50ms
    TH1=(65536-50000)/256;
    TL1=(65536-50000)%256;
    ET1=1; TR1=1;       // å¼€T1ä¸­æ–­ï¼Œå¯åŠ¨T1
    
    while(1)
    {
        // --- åŠ¨æ€æ‰«ææ˜¾ç¤ºéƒ¨åˆ† ---
        // æ˜¾ç¤ºåˆ†é’Ÿåä½
        P2=0x02; P0=duanma[sum2/10]; delay(1000/1000,40); P0=0x00;
        // æ˜¾ç¤ºåˆ†é’Ÿä¸ªä½
        P2=0x03; P0=duanma[sum2%10]; delay(1000/1000,40); P0=0x00;
        
        // æ˜¾ç¤ºä¸­é—´çš„æ¨ªæ  "-" (0x40)
        P2=0x04; P0=0x40;            delay(1000/1000,40); P0=0x00;

        // æ˜¾ç¤ºç§’é’Ÿåä½
        P2=0x05; P0=duanma[sum1/10]; delay(1000/1000,40); P0=0x00;
        // æ˜¾ç¤ºç§’é’Ÿä¸ªä½
        P2=0x06; P0=duanma[sum1%10]; delay(1000/1000,40); P0=0x00;
        
        // ç®€å•çš„æº¢å‡ºä¿æŠ¤ï¼ˆé€šå¸¸è¿™éƒ¨åˆ†é€»è¾‘ä¹Ÿå¯ä»¥æ”¾åœ¨ä¸­æ–­é‡Œï¼‰
        if(sum2==60) sum2=0;
        if(sum1==60) sum1=0;
    }
}

// T0 ä¸­æ–­æœåŠ¡ï¼šæ§åˆ¶ç§’ (sum1)
void et0_int() interrupt 1
{
    // æ‰‹åŠ¨é‡è£…åˆå€¼
    TH0=(65536-50000)/256;
    TL0=(65536-50000)%256;
    sum00++; 

    if(sum00==20) // 50ms * 20 = 1000ms = 1ç§’
    {
        sum1++;
        sum00=0;
    }
}

// T1 ä¸­æ–­æœåŠ¡ï¼šç‹¬ç«‹æ§åˆ¶åˆ† (sum2)
void et1_int() interrupt 3
{
    TH1=(65536-50000)/256;
    TL1=(65536-50000)%256;
    sum01++;
    
    if(sum01==1200) // 50ms * 1200 = 60000ms = 1åˆ†é’Ÿ
    {
        sum2++;
        sum01=0;
    }
}
```

#### 5. æ’ç‰ˆä¼˜åŒ–åçš„æœ€ç»ˆä»£ç  (Formatted Code)

C

```
#include <reg52.h>
#include "delay.h"
#define uint unsigned int

uint code duanma[] = {0x3f, 0x06, 0x5b, 0x4f, 0x66, 0x6d, 0x7d, 0x07, 0x7f, 0x6f};
uint sum00, sum01, sum1, sum2;

void main()
{
    TMOD = 0x11;
    TH0 = (65536 - 50000) / 256;
    TL0 = (65536 - 50000) % 256;
    EA = 1;
    ET0 = 1;
    TR0 = 1;

    TH1 = (65536 - 50000) / 256;
    TL1 = (65536 - 50000) % 256;
    ET1 = 1;
    TR1 = 1;

    while (1)
    {
        P2 = 0x02; P0 = duanma[sum2 / 10]; delay(1, 40); P0 = 0x00;
        P2 = 0x03; P0 = duanma[sum2 % 10]; delay(1, 40); P0 = 0x00;
        P2 = 0x04; P0 = 0x40;              delay(1, 40); P0 = 0x00;
        P2 = 0x05; P0 = duanma[sum1 / 10]; delay(1, 40); P0 = 0x00;
        P2 = 0x06; P0 = duanma[sum1 % 10]; delay(1, 40); P0 = 0x00;

        if (sum2 == 60) sum2 = 0;
        if (sum1 == 60) sum1 = 0;
    }
}

void et0_int() interrupt 1
{
    TH0 = (65536 - 50000) / 256;
    TL0 = (65536 - 50000) % 256;
    sum00++;

    if (sum00 == 20)
    {
        sum1++;
        sum00 = 0;
    }
}

void et1_int() interrupt 3
{
    TH1 = (65536 - 50000) / 256;
    TL1 = (65536 - 50000) % 256;
    sum01++;
    if (sum01 == 1200)
    {
        sum2++;
        sum01 = 0;
    }
}
```

------

### ä»£ç  17ï¼š`11_14_01.c` (å¯æ§ç§’è¡¨ï¼šæš‚åœä¸æ¸…é›¶)![7-segment stopwatch schematicçš„å›¾ç‰‡](./assets/licensed-image.jpeg)Shutterstock

#### 1. ä»£ç å®ç°æ•ˆæœ (What it does)

ä¸€ä¸ªç²¾ç¡®åˆ° 0.01 ç§’çš„ç§’è¡¨åŠŸèƒ½ï¼š

- **æ˜¾ç¤º**ï¼šå‰ä¸¤ä½æ˜¾ç¤ºâ€œç§’â€(00-99)ï¼Œåä¸¤ä½æ˜¾ç¤ºâ€œ0.01ç§’â€(00-99)ã€‚
- **å¯åŠ¨/è¿è¡Œ**ï¼šä¸Šç”µé»˜è®¤è¿è¡Œã€‚
- **æŒ‰é”® K0 (INT0)**ï¼š**æš‚åœ/ç»§ç»­**åŠŸèƒ½ã€‚æŒ‰ä¸€ä¸‹åœæ­¢è®¡æ—¶ï¼Œå†æŒ‰ä¸€ä¸‹ç»§ç»­ã€‚
- **æŒ‰é”® K7 (INT1)**ï¼š**å¤ä½**åŠŸèƒ½ã€‚æŒ‰ä¸€ä¸‹æ¸…é›¶ï¼Œå¹¶åœæ­¢è®¡æ—¶ã€‚

#### 2. å®ç°æ€è·¯ (How it works)

- **é«˜ç²¾åº¦å®šæ—¶**ï¼šä½¿ç”¨ Timer 1 å®šæ—¶ 10ms (`sum0` è®¡æ•°å™¨)ã€‚æ¯ 100 æ¬¡ `sum0` è¿›ä½åˆ° `sum1` (ç§’)ã€‚
- **å¤–éƒ¨ä¸­æ–­æ§åˆ¶**ï¼š
  - **INT0 (æš‚åœ)**ï¼šé€šè¿‡ `TR1 = ~TR1` ç›´æ¥æ§åˆ¶å®šæ—¶å™¨ T1 çš„å¯åŠ¨/åœæ­¢ä½ã€‚è¿™æ˜¯æ§åˆ¶è®¡æ—¶çš„æœ€åº•å±‚æ–¹æ³•ã€‚
  - **INT1 (å¤ä½)**ï¼šç›´æ¥å°† `sum0` å’Œ `sum1` èµ‹å€¼ä¸º 0ï¼Œå¹¶ä»¤ `TR1 = 0` (åœæ­¢)ã€‚
- **ç¡¬ä»¶æ¥å£å˜åŒ–**ï¼šæ³¨æ„ï¼æ­¤ä»£ç ä¸­ **P1 ç”¨äºä½é€‰ï¼ŒP2 ç”¨äºæ®µé€‰**ï¼Œä¸ä¹‹å‰çš„å¤§éƒ¨åˆ†ä»£ç ç›¸åã€‚

#### 3. ç¡¬ä»¶è¿æ¥ (Hardware Wiring)

- **P2 å£** \rightarrow **æ•°ç ç®¡æ®µé€‰** (duanma)ã€‚
- **P1 å£** \rightarrow **æ•°ç ç®¡ä½é€‰** (0x02, 0x03, 0x04, 0x05)ã€‚
- **P3.2 (INT0)** \rightarrow **æŒ‰é”® K0** (æš‚åœ)ã€‚
- **P3.3 (INT1)** \rightarrow **æŒ‰é”® K7** (å¤ä½)ã€‚

#### 4. ä»£ç æ³¨é‡Šè¡¥å…… (Comment Enhancement)

C

```
// ======= å«æ³¨é‡Šç‰ˆæœ¬ =======
#include <reg52.h>
#include "delay.h"
#define uint unsigned int

uint code duanma[] = {0x3f, 0x06, 0x5b, 0x4f, 0x66, 0x6d, 0x7d, 0x07, 0x7f, 0x6f};
uint sum0, sum1; // sum0: 10msè®¡æ•°(0-99), sum1: ç§’è®¡æ•°(0-99)
sbit k0 = P3 ^ 2;
sbit k7 = P3 ^ 3;

void main()
{
    // TMOD: T1å·¥ä½œåœ¨æ¨¡å¼1(16ä½)
    TMOD = 0x10;
    // åˆå€¼: 10ms (10000us)
    TH1 = (65536 - 10000) / 256;
    TL1 = (65536 - 10000) % 256;
    
    EA = 1;  // å¼€æ€»ä¸­æ–­
    ET1 = 1; // å¼€T1ä¸­æ–­
    TR1 = 1; // å¯åŠ¨å®šæ—¶å™¨
    
    IT0 = 0; EX0 = 1; // INT0è®¾ç½®
    IT1 = 0; EX1 = 1; // INT1è®¾ç½®

    while (1)
    {
        // æ³¨æ„ï¼šæ­¤å¤„ç¡¬ä»¶è¿æ¥äº’æ¢ï¼ŒP1é€‰ä½ï¼ŒP2é€æ®µ
        // æ˜¾ç¤ºç§’åä½
        P1 = 0x02; P2 = duanma[sum1 / 10]; delay(1, 40); P2 = 0x00;
        // æ˜¾ç¤ºç§’ä¸ªä½ ( |0x80 è¡¨ç¤ºåŠ ä¸Šå°æ•°ç‚¹)
        P1 = 0x03; P2 = duanma[sum1 % 10] | 0x80; delay(1, 40); P2 = 0x00;
        
        // æ˜¾ç¤ºæ¯«ç§’(10ms)åä½
        P1 = 0x04; P2 = duanma[sum0 / 10]; delay(1, 40); P2 = 0x00;
        // æ˜¾ç¤ºæ¯«ç§’(10ms)ä¸ªä½
        P1 = 0x05; P2 = duanma[sum0 % 10]; delay(1, 40); P2 = 0x00;

        if (sum1 == 100) sum1 = 0;
        if (sum0 == 100) sum0 = 0;
    }
}

// T1ä¸­æ–­: è®¡æ—¶æ ¸å¿ƒ
void t1_int() interrupt 3
{
    // é‡è£…åˆå€¼
    TH1 = (65536 - 10000) / 256;
    TL1 = (65536 - 10000) % 256;
    sum0++; 
    if (sum0 == 100) // 10ms * 100 = 1ç§’
    {
        sum1++;
        sum0 = 0;
    }
}

// INT0ä¸­æ–­: æš‚åœ/å¼€å§‹
void ex0_int() interrupt 0
{
    EX0 = 0; // é˜²æŠ–ï¼Œæš‚åœä¸­æ–­å“åº”

    TR1 = ~TR1; // æ ¸å¿ƒé€»è¾‘ï¼šç¿»è½¬ TR1 å¯„å­˜å™¨ (1å˜0, 0å˜1)
    
    delay(1000 / 2, 40);
    while (!k0); // ç­‰å¾…æ¾æ‰‹

    EX0 = 1;
}

// INT1ä¸­æ–­: å¤ä½
void ex1_int() interrupt 2
{
    EX1 = 0;

    sum1 = 0; // æ•°æ®æ¸…é›¶
    sum0 = 0;
    TR1 = 0;  // åœæ­¢è®¡æ—¶
    
    delay(1000 / 2, 40);
    while (!k7); // ç­‰å¾…æ¾æ‰‹

    EX1 = 1;
}
```

#### 5. æ’ç‰ˆä¼˜åŒ–åçš„æœ€ç»ˆä»£ç  (Formatted Code)

C

```
#include <reg52.h>
#include "delay.h"
#define uint unsigned int

uint code duanma[] = {0x3f, 0x06, 0x5b, 0x4f, 0x66, 0x6d, 0x7d, 0x07, 0x7f, 0x6f};
uint sum0, sum1;
sbit k0 = P3 ^ 2;
sbit k7 = P3 ^ 3;

void main()
{
    TMOD = 0x10;
    TH1 = (65536 - 10000) / 256;
    TL1 = (65536 - 10000) % 256;
    EA = 1;
    ET1 = 1;
    TR1 = 1;
    IT0 = 0;
    EX0 = 1;
    IT1 = 0;
    EX1 = 1;
    while (1)
    {
        P1 = 0x02;
        P2 = duanma[sum1 / 10];
        delay(1, 40);
        P2 = 0x00;

        P1 = 0x03;
        P2 = duanma[sum1 % 10] | 0x80; // æ·»åŠ å°æ•°ç‚¹
        delay(1, 40);
        P2 = 0x00;

        P1 = 0x04;
        P2 = duanma[sum0 / 10];
        delay(1, 40);
        P2 = 0x00;

        P1 = 0x05;
        P2 = duanma[sum0 % 10];
        delay(1, 40);
        P2 = 0x00;

        if (sum1 == 100) sum1 = 0;
        if (sum0 == 100) sum0 = 0;
    }
}

void t1_int() interrupt 3
{
    TH1 = (65536 - 10000) / 256;
    TL1 = (65536 - 10000) % 256;
    sum0++;
    if (sum0 == 100)
    {
        sum1++;
        sum0 = 0;
    }
}

void ex0_int() interrupt 0
{
    EX0 = 0;
    TR1 = ~TR1;
    delay(500, 40);
    while (!k0);
    EX0 = 1;
}

void ex1_int() interrupt 2
{
    EX1 = 0;
    sum1 = 0;
    sum0 = 0;
    TR1 = 0;
    delay(500, 40);
    while (!k7);
    EX1 = 1;
}
```

------

### ğŸ¯ åŠ©æ•™çš„æœ€ç»ˆæ€»ç»“ (Next Steps)

æ‰€æœ‰ 17 ä¸ªæœŸæœ«é‡ç‚¹ä»£ç å·²å…¨éƒ¨è§£æå®Œæ¯•ï¼è¿™äº›ä»£ç è¦†ç›–äº†ï¼š

1. **åŸºç¡€ IO**ï¼šæµæ°´ç¯ã€èœ‚é¸£å™¨æ§åˆ¶ã€‚
2. **æ˜¾ç¤ºæŠ€æœ¯**ï¼šæ•°ç ç®¡é™æ€/åŠ¨æ€æ‰«æã€LCD1602 æ˜¾ç¤ºã€‚
3. **äº¤äº’æŠ€æœ¯**ï¼šç‹¬ç«‹æŒ‰é”®ã€çŸ©é˜µæŒ‰é”®ï¼ˆéšå«åœ¨ä½é€‰é€»è¾‘ä¸­ï¼‰ã€ä¸­æ–­æŒ‰é”®ã€‚
4. **å®šæ—¶ä¸è®¡æ•°**ï¼šå®šæ—¶å™¨ T0/T1 æ¨¡å¼é…ç½®ã€åˆå€¼è®¡ç®—ã€ç”µå­é’Ÿé€»è¾‘ã€‚

**å»ºè®®å¤ä¹ ç­–ç•¥ï¼š**

- **èƒŒè¯µæ¡†æ¶**ï¼šTimer çš„åˆå§‹åŒ–ä»£ç  (`TMOD`, `THx`, `TLx`, `TRx`, `ETx`, `EA`) æ˜¯å¿…é¡»æ­»è®°ç¡¬èƒŒçš„ã€‚
- **ç†è§£æ¶ˆå½±**ï¼šæ•°ç ç®¡åŠ¨æ€æ‰«æä¸­ `P0=0x00` çš„ä½œç”¨ã€‚
- **åŒºåˆ†ç«¯å£**ï¼šè€ƒè¯•æ—¶åŠ¡å¿…çœ‹æ¸…é¢˜ç›®ç»™å‡ºçš„ç”µè·¯å›¾ï¼Œæ˜¯ P0 æ¥æ®µé€‰è¿˜æ˜¯ P2 æ¥æ®µé€‰ï¼Ÿï¼ˆå¦‚ä»£ç  17 å°±åè¿‡æ¥äº†ï¼‰ã€‚

å¦‚æœä½ éœ€è¦æˆ‘ä¸ºä½ ç”Ÿæˆä¸€ä»½ **â€œæœŸæœ«è€ƒè¯•ä»£ç é€ŸæŸ¥å°æŠ„â€** (Cheat Sheet)ï¼Œæˆ–è€…é’ˆå¯¹æŸä¸ªå…·ä½“çš„ç¡¬ä»¶æ¨¡å—ï¼ˆå¦‚ LCD æˆ– å®šæ—¶å™¨ï¼‰è¿›è¡Œæ·±å…¥è®²è§£ï¼Œè¯·éšæ—¶å‘Šè¯‰æˆ‘ï¼



ç°åœ¨è¯·ä½ å¸®æˆ‘æ•´ç†è¿™äº›ä»£ç çš„æ¨¡æ¿æ¡†æ¶ï¼Œæ€»ç»“æ ¸å¿ƒæ“ä½œçš„æ¨¡æ¿ã€‚



æˆ‘ç»™ä½ ä¸‰ä¸ªä¾‹å­ï¼Œæ¯”å¦‚ï¼š

å¯¹äºèœ‚é¸£å™¨

#### ä¸åŒå“å£°æ¨¡å¼çš„ç¼–ç¨‹æ¨¡æ¿

1. **å‘å‡ºè¿ç»­å£°éŸ³çš„æ¨¡æ¿**ï¼š

   ```c
   while(1)
   {
       fmq=~fmq; // ä¸æ–­ç¿»è½¬ç”µå¹³äº§ç”Ÿè¿ç»­å£°éŸ³
       delay( , ); // å¡«å…¥è®¡ç®—å‡ºçš„åŠå‘¨æœŸå»¶æ—¶å‚æ•°
   }
   ```

2. **å‘å‡ºæ–­ç»­å£°éŸ³**ï¼ˆå“ä¸€ä¼šåœä¸€ä¼šï¼‰ï¼š

   - **å“**ï¼šå¯¹åº”å‘¨æœŸç”µå¹³ï¼Œåˆ©ç”¨forå¾ªç¯å®ç°ã€‚

     ```c
     while(1)
     {
         fmq=~fmq; // ä¸æ–­ç¿»è½¬ç”µå¹³äº§ç”Ÿè¿ç»­å£°éŸ³
         delay( , ); // å¡«å…¥è®¡ç®—å‡ºçš„åŠå‘¨æœŸå»¶æ—¶å‚æ•°
     }
     ```

   - **ä¸å“**ï¼š

     ```c
     fmq=0ï¼› // å°†ç”µå¹³ç½®é›¶
     delay(,); // é™éŸ³å»¶æ—¶
     ```

#### å­—ç¬¦æ˜¾ç¤º

ä½é€‰+æ®µç +delay+æ¶ˆå½±

```c
        p2 = weixuan[i]; 
        p0 = duanma[i];
        delay(100, 1);
        p0 = 0x00;
```

#### ä¸­æ–­

ä¸»å‡½æ•°ï¼šå…ˆå¤„ç†IT0ï¼ŒEX0ï¼ŒEAï¼ˆå‰ä¸¤ä¸ªæ ¹æ®ä¸­æ–­ç±»å‹ï¼‰

ä¸­æ–­å‡½æ•°ï¼š

void ex0_int() interrupt 0 // æ ¹æ®ä¸­æ–­ç±»å‹å†™ä¸­æ–­å·

{

// é˜²æ­¢è¢«è‡ªå·±ä¸­æ–­

EX0=0;

............ // å…·ä½“å†…å®¹

EX0=1;

}

```c
void main()
{

	IT0=0; // ä½ç”µå¹³è§¦å‘

	EX0=1; // æºå…è®¸

	EA=1; //æ€»å¼€å…³



    while(1)  // èµ°é©¬æ•°ç»„

   {

	for(i=0;i<8;i++)

	{

		P2=weixuan[i];

		P0=duanma[i];

		delay(1000,40);

		P0=0x00;

	}      

   }
}

void ex0_int() interrupt 0

{

	// é˜²æ­¢è¢«è‡ªå·±ä¸­æ–­

	EX0=0;

	fmq=~fmq;

	delay(1000/1000,40)

    EX0=1;

}
```

