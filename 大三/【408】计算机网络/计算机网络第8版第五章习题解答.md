根据你上传的《计算机网络第8版课件-第5章-运输层.pptx》文件，我为你整理了这四道习题的知识点讲解、解题思路以及参考答案。

------

### 5-09 端口的作用是什么？为什么端口号要划分为三种？

#### 1. 知识点讲解

- **端口的作用**： **复用与分用**：运输层为应用进程之间提供端到端的逻辑通信。为了能让接收方知道数据应该交付给哪个应用进程（因为一台计算机上可能同时运行多个进程），需要一个标识。端口就是用来标志应用层中各个进程的，它通过复用和分用功能，将运输层与应用层连接起来。 **屏蔽底层细节**：端口作为通信的抽象终点，使得应用进程看见的好像是在两个运输层实体之间有一条端到端的逻辑通信信道。
- **端口的分类**：TCP/IP 的端口号使用 16 位进行标志，共有 65,535 个。为了规范管理，避免冲突，端口号被划分为不同的范围。

#### 2. 解题思路

- 回答“作用”时，重点强调“标志进程”和“复用/分用”。
- 回答“划分”时，需要列出三种端口类型（熟知、登记、短暂）及其对应的数值范围和使用场景。

#### 3. 参考答案

**端口的作用：**

端口是应用层与运输层的服务接口，用于标志计算机应用层中的各个进程。其主要作用是实现**复用**（多个进程使用同一个运输层协议传输数据）和**分用**（运输层收到数据后根据端口号将数据交付给正确的进程）。

**为什么端口号要划分为三种：**

为了有效地管理和分配端口资源，避免不同应用进程之间的端口冲突，端口号被划分为以下三种：

1. **熟知端口 (Well-known Ports)**：数值为 0∼1023。这些端口号分配给互联网上最常用的服务器程序（如 HTTP 的 80，FTP 的 21 等），由 IANA 指派，全球通用。
2. **登记端口 (Registered Ports)**：数值为 1024∼49151。供没有熟知端口的应用程序在 IANA 登记使用，防止重复。
3. **短暂端口 (Ephemeral Ports)**：数值为 49152∼65535。仅在客户进程运行时动态选择，通信结束后由系统收回，供其他进程使用。

------

### 5-14 UDP 用户数据报分析

#### 1. 知识点讲解

- **UDP 首部格式**：UDP 首部只有 8 个字节，分为 4 个字段，每个字段 2 字节。 **源端口**：第 1-2 字节。 **目的端口**：第 3-4 字节。 **长度**：第 5-6 字节（包含首部和数据）。 **检验和**：第 7-8 字节。
- **熟知端口**：TFTP 协议使用的熟知端口是 69。

#### 2. 解题思路

给出的十六进制数据为：`06 32 00 45 00 1C E2 17`。

1. 

   **解析源端口**：取前两个字节 `06 32`，转换为十进制。

   ```
   6×162+3×16+2=6×256+50=1536+50=1586
   ```

2. 

   **解析目的端口**：取第 3-4 字节 `00 45`，转换为十进制。

   ```
   4×16+5=64+5=69
   ```

3. 

   **解析总长度**：取第 5-6 字节 `00 1C`，转换为十进制。

   ```
   1×16+12=28
   ```

4. **计算数据部分长度**：总长度减去首部长度（8 字节）。

5. **判断方向与服务**：端口 69 对应 TFTP 服务。源端口 1586 是客户端口，目的端口 69 是服务器端口。

#### 3. 参考答案

- **源端口**：1586
- **目的端口**：69
- **用户数据报的总长度**：28字节
- **数据部分长度**：28−8=20字节
- **发送方向**：从**客户**发送给**服务器**（因为目的端口 69 是熟知端口，源端口 1586 是短暂/登记端口）。
- **服务器程序**：**TFTP**（简单文件传送协议）。

------

### 5-22 TCP 序号与文件传输时间计算

#### 1. 知识点讲解

- **TCP 序号范围**：TCP 首部中的序号字段占 4 字节（32位），序号范围是 0∼232−1。
- **传输时间计算**： 需要传输的总比特数 = (文件数据长度 + 所有分组的首部开销) ×8。 传输时间 = 总比特数 / 数据率。
- **MSS (最大报文段长度)**：指 TCP 报文段中数据字段的最大长度。

#### 2. 解题思路

**（1）L 的最大值**

TCP 序号不重复使用的限制就是序号空间的大小。

```
Lmax=232 字节≈4 GB
```

**（2）最短发送时间**

- **已知**：L=232字节，MSS=1460字节，首部开销/分组 =66字节，数据率 C=10 Mbit/s。

- 

  **步骤 1：计算分组数量**

  ```
  N=⌈MSSL⌉=⌈1460232⌉
  ```

  ```
  232=4,294,967,296
  ```

  ```
  N=⌈2,941,758.42⌉=2,941,759 个分组
  ```

- 

  **步骤 2：计算总传输字节数**

  ```
  总字节=L+(N×首部开销)
  ```

  ```
  总字节=4,294,967,296+(2,941,759×66)
  ```

  ```
  2,941,759×66=194,156,094 字节
  ```

  ```
  总字节=4,294,967,296+194,156,094=4,489,123,390 字节
  ```

- 

  **步骤 3：计算传输时间**

  ```
  总比特=4,489,123,390×8=35,912,987,120 bit
  ```

  ```
  时间 t=C总比特=10×10635,912,987,120≈3591.3 秒
  ```

#### 3. 参考答案

（1）在 TCP 序号不重复使用的条件下，L 的最大值是 232=4,294,967,296字节（约 4GB）。

（2）该文件所需的最短发送时间约为 **3591.3 秒**。

- 分组数：⌈4294967296/1460⌉=2941759个。
- 总开销字节：2941759×66=194156094字节。
- 总发送比特：(4294967296+194156094)×8≈3.591×1010bit。
- 发送时间：3.591×1010/107≈3591.3秒。

------

### 5-23 TCP 报文段序号与确认号分析

#### 1. 知识点讲解

- **序号 (Seq)**：指的是本报文段所发送的数据的第一个字节的序号。
- **确认号 (Ack)**：是期望收到对方下一个报文段的数据的第一个字节的序号。若 Ack=N，表明到序号 N−1为止的所有数据都已正确收到。
- **累积确认**：TCP 使用累积确认，只确认按序到达的最后一个分组。

#### 2. 解题思路

- **背景**：连续发送两个报文段。 报文段 1 序号：Seq1=70 报文段 2 序号：Seq2=100
- **（1）第一个报文段的数据量**： 由于报文段 2 的序号是 100，说明报文段 2 的第一个字节是 100。因此报文段 1 的数据范围是 70∼99。 数据长度 =100−70=30字节。
- **（2）收到第一个报文段后的确认号**： B 收到了 70∼99，期望收到的下一个字节是 100。 Ack=100。
- **（3）收到第二个报文段后的确认号是 180**： 确认号 180 意味着 0∼179字节都已收到。报文段 2 从 100 开始，所以报文段 2 的数据范围是 100∼179。 数据长度 =180−100=80字节。
- **（4）第一个丢失，第二个到达**： B 收到了报文段 2（100∼179），但没收到报文段 1（70∼99）。 由于 TCP 是累积确认，B 只能确认它按序收到的最后一个字节。假设在发送报文段 1 之前，数据是连续的（即 B 已经收到了 69 及其之前的数据，期望收到 70），那么此时 B 仍期望收到序号 70。 Ack=70。

#### 3. 参考答案

（1）第一个报文段携带了 **30** 字节的数据 (100−70)。

（2）主机 B 收到第一个报文段后发回的确认中的确认号应当是 **100**。

（3）A 发送的第二个报文段中的数据有 **80** 字节 (180−100)。

（4）这个确认号应为 **70**。

*(因为 TCP 使用累积确认，虽然收到了序号 100 开始的数据，但序号 70 开始的数据未收到，B 只能请求它期望收到的下一个按序字节，即 70)*。