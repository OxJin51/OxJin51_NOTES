# ASP.NET 控件知识库 (第4章)

## 一、 ASP.NET 控件概述 (3.2)

ASP.NET 的便捷性关键在于其强大的控件库 1。控件主要分为以下几类：

- **HTML 控件 (3.2.1)**

  - 即标准的 HTML 语言标签 。
  - 它们在客户端运行，只能通过 JavaScript 或 VBScript 等客户端脚本进行控制 。

- **HTML 服务器控件 (3.2.2)**

  - 是在标准 HTML 控件的基础上增加了 `runat="server"` 属性构成的 。
  - 它们运行在服务器端，允许后台代码进行操作 5。

- **Web 服务器控件 (3.2.3)**

  - 也称为 ASP.NET 服务器控件，是 Web Form 编程的核心元素 6。

  - 这些控件在服务器上运行，并根据客户端（浏览器）的情况生成相应的 HTML 元素 。

  - 功能比 HTML 控件更强大，包含了如日历、数据绑定等高级功能的控件 。

    

    

------



## 二、 常用服务器控件详解 (3.3)

Web 控件是动态网页技术的一大进步，将后台程序与前端网页真正融合在一起 9。

### 3.3.1 文本框 (TextBox)

主要用于文本输入 。

| 常用属性           |                             说明                             |
| ------------------ | :----------------------------------------------------------: |
| **`AutoPostBack`** |         设置当文本内容改变时是否自动回传到服务器 。          |
| **`Columns`**      |             设置文本框的显示宽度（以字符为单位。             |
| **`MaxLength`**    |                   设置可输入的最大字符数。                   |
| **`ReadOnly`**     |                  设置文本框内容是否为只读。                  |
| **`Rows`**         |                    设置多行文本框的行数。                    |
| **`Text`**         |                  获取或设置文本框中的内容。                  |
| **`TextMode`**     | 设置文本框的模式，如 `SingleLine`、`MultiLine` 或 `Password` 。 |
| **`Wrap`**         |               设置多行文本框内容是否自动换行。               |

|     常用事件      |                说明                |
| :---------------: | :--------------------------------: |
| **`TextChanged`** | 当文本框内容改变且焦点离开时触发。 |

### 3.3.2 按钮 (Button)

主要用于交互式命令操作 。

| 常用属性              |             说明              |
| --------------------- | :---------------------------: |
| **`Text`**            |  获取或设置按钮上显示的文本   |
| **`CommandName`**     |   设置与按钮关联的命令名称    |
| **`CommandArgument`** | 设置传递给Command` 事件的参数 |

| 常用事件      | 说明                                                         |
| ------------- | ------------------------------------------------------------ |
| **`Click`**   | 用户单击按钮时触发 。                                        |
| **`Command`** | 当按钮的 `Click` 事件发生时，同时触发此事件，常用于区分多个按钮的命令 |



### 3.3.3 单选框 (RadioButton)

主要用于数据列表选项 。

### 3.3.4 链接按钮 (LinkButton)

外观像超链接的按钮，主要用于交互式命令操作 27。

### 3.3.5 列表框 (ListBox)

主要用于显示数据列表 。

### 3.3.6 复选框 (CheckBox)

主要用于交互式的数据选项 。

| 常用属性           |                    说明                     |
| ------------------ | :-----------------------------------------: |
| **`Checked`**      |       获取或设置复选框是否被选中 30。       |
| **`AutoPostBack`** | 设置当选中状态改变时是否自动回传到服务器 。 |

| 常用事件             |               说明               |
| -------------------- | :------------------------------: |
| **`CheckedChanged`** | 当 `Checked` 属性值改变时触发 。 |



### 3.3.7 图像 (Image)

主要用于显示图像 。

| 常用属性            |                  说明                   |
| ------------------- | :-------------------------------------: |
| **`ImageUrl`**      |        设置要显示的图像的 URL 。        |
| **`AlternateText`** |   当图像无法显示时，显示的替代文本 。   |
| **`ImageAlign`**    | 设置图像相对于页面其他元素的对齐方式 。 |

## 三、 登录与安全配置

### 3.1 站点配置 (`Web.Config`)

- **作用**：`Web.Config` 是一个 XML 文件，用于存储 ASP.NET 应用程序的配置信息。
- **继承性**：子目录会继承父目录的配置，也可以通过在子目录中新建 `Web.Config` 文件来重写设置 。
- **生效机制**：对 `Web.Config` 文件的修改无需重启服务即可生效（`<processModel>` 节除外）。

### 3.4 & 3.6 安全性与登录

ASP.NET 提供了一套完整的登录控件和基于角色的安全机制来管理用户访问。

#### 1. 身份验证 (`authentication`) 与授权 (`authorization`)

`Web.Config` 中有两个核心元素用于登录验证：

- **`<authentication>`**：配置应用程序的身份验证模式。
  - **`Windows`**: 与 IIS 身份验证结合，适用于内网。
  - **`Forms`**: 基于表单的身份验证，适用于公共 Internet 应用。
  - **`Passport`**: 使用 Microsoft Passport Network 身份验证。
  - **`None`**: 不指定任何身份验证。
- **`<authorization>`**：控制客户端对 URL 资源的访问权限。

#### 2. 登录控件套件 (3.4.2)

- **`Login`**: 提供标准的用户登录界面（用户名、密码。
- **`LoginView`**: 根据用户的登录状态显示不同的内容模板 。
- **`LoginStatus`**: 显示用户的登录状态（“登录”或“注销”链接）。
- **`LoginName`**: 显示已登录用户的用户名。
- **`PasswordRecovery`**: 提供“忘记密码”功能，帮助用户找回密码。
- **`CreateUserWizard`**: 提供用户注册向导界面。
- **`ChangePassword`**: 提供修改密码的用户界面。

#### 3. 登录实现流程

- **普通登录 (3.5)**

  1. **用户注册**：使用 `CreateUserWizard` 控件实现.
  2. **用户登录**：使用 `Login` 控件实现 .
  3. **修改密码**：使用 `ChangePassword` 控件实现 56。
  4. **显示状态**：登录后，使用 `LoginName` 显示欢迎信息，`LoginStatus` 提供退出链接 57。

- **基于角色的登录 (3.6)**

  1. **启用角色管理**：在配置工具中首先启用角色管理功能 58。
  2. **创建角色**：定义用户角色，如“管理员”、“普通用户”等 59。
  3. **创建访问规则**：为不同角色设置对网站或文件夹的访问权限（允许或拒绝） 60。
  4. **赋予用户角色**：将已注册的用户添加到特定角色中 61。
  5. **验证登录**：在 `Web.Config` 中进行设置，只允许特定角色的成员访问受限资源。

- **匿名用户管理 (3.7)**

  - ASP.NET 可以为未登录的匿名用户自动分配一个唯一 ID。

  - 这使得即使在用户未注册或登录的情况下，也能存储与该用户相关的信息，非常适用于实现网站的个性化功能 。

    

    